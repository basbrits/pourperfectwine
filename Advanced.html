<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üç∑ The Perfect Pour: Dynamic Wine Pairing</title>
    
    <style>
        /* --- General Styling --- */
        body {
            font-family: 'Georgia', serif;
            margin: 0;
            padding: 0;
            background-color: #f8f7f4;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            width: 90%;
            margin: 40px auto;
            padding: 40px;
            background-color: #ffffff;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        h1 {
            color: #8a032d;
            text-align: center;
            font-family: 'Playfair Display', serif;
            margin-bottom: 10px;
            font-size: 2.5em;
        }

        h2 {
            color: #555;
            text-align: center;
            margin-top: 5px;
            font-weight: 300;
            font-size: 1.1em;
        }

        hr {
            border: 0;
            height: 1px;
            background-image: linear-gradient(to right, rgba(0, 0, 0, 0), #8a032d, rgba(0, 0, 0, 0));
            margin: 20px 0;
        }
        
        /* --- Breadcrumbs (History Navigation) --- */
        #breadcrumbs {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .breadcrumb-item {
            background-color: #eee;
            color: #555;
            border: 1px solid #ddd;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
        }

        .breadcrumb-item:hover {
            background-color: #ddd;
            border-color: #ccc;
        }

        .breadcrumb-item::before {
            content: "¬´ ";
            margin-right: 4px;
            color: #8a032d;
            font-weight: bold;
        }

        /* --- Dynamic Control Area --- */
        #step-prompt {
            display: block;
            margin-bottom: 15px;
            font-weight: bold;
            color: #333;
            font-size: 1.2em;
            text-align: center;
        }
        
        .button-group {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            justify-content: center;
        }

        .emoji-button {
            flex-grow: 1;
            padding: 12px 15px;
            border: 2px solid #ccc;
            border-radius: 10px;
            background-color: #fff;
            color: #333;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            min-width: 130px;
            max-width: 220px;
            font-weight: 600;
        }
        
        .emoji-button span.emoji {
            font-size: 1.5em;
            display: block;
            margin-bottom: 4px;
        }

        .emoji-button:hover {
            border-color: #b3003b;
            background-color: #f7e0e7;
        }
        
        /* Styles for Multi-Select Mode */
        .emoji-button.multi-select-active {
            background-color: #8a032d;
            color: white;
            border-color: #8a032d;
        }

        #next-step-btn {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1.1em;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 15px;
            display: none; /* Hidden by default */
            width: 100%;
            max-width: 300px;
        }
        
        #next-step-btn:hover {
            background-color: #218838;
        }

        /* --- Result Area --- */
        .result-title {
            color: #8a032d;
            text-align: center;
            font-size: 1.5em;
            margin-top: 30px;
            margin-bottom: 10px;
            font-weight: bold;
            display: none; /* Hidden until result */
        }

        #result {
            margin-top: 15px;
            padding: 25px;
            border: 2px solid #8a032d;
            border-radius: 10px;
            background-color: #fcf4f5;
            text-align: center;
            font-size: 1.1em;
            color: #333;
            display: none; /* Hidden until result */
        }

        #result strong {
            color: #8a032d;
            font-size: 1.2em;
        }

        #result .rationale {
            font-style: italic;
            font-size: 0.9em;
            color: #555;
            margin-top: 15px;
            padding-top: 10px;
            border-top: 1px dashed #ccc;
        }
        
        #reset-button {
            display: block;
            width: 50%;
            margin: 20px auto 0;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background-color: #555;
            color: white;
            cursor: pointer;
            font-weight: bold;
        }
        
        #reset-button:hover {
            background-color: #333;
        }
        
        /* Helper for warnings */
        .multi-select-warning {
            color: #d9534f;
            font-size: 0.9em;
            margin-top: 5px;
            display: none;
        }

    </style>
</head>
<body>

    <div class="container">
        <h1>üç∑ The Perfect Pour</h1>
        <h2>Your Personal Sommelier</h2>
        <hr>

        <div id="breadcrumbs"></div>

        <div id="steps-container">
            <label id="step-prompt">1. Choose Cuisine Style:</label>
            
            <div class="button-group" id="button-options-container">
                </div>
            
            <p id="multi-warning" class="multi-select-warning">Please select 1 or 2 options.</p>
            <div style="text-align: center;">
                <button id="next-step-btn">Next Step ‚ûî</button>
            </div>
        </div>

        <div class="result-title" id="res-title">Your Expert Pairing:</div>
        <div id="result"></div>
    </div>

    <script>
        // ==========================================
        // DATA STRUCTURE
        // ==========================================
        
        // Helper to keep the file shorter - I've kept the structure but focused on the Festive Data
        const winePairings = {
           "Italian": {
                "title": "Italian Cuisine üáÆüáπ",
                "next_prompt": "2. Choose Initial Category:",
                "emoji": "üáÆüáπ",
                "options": {
                    // Level 2: INITIAL CATEGORY
                    "Pasta / Gnocchi": {
                        "user_label": "üçù Pasta & Noodles",
                        "next_prompt": "3. Choose Dominant Sauce Style:",
                        "options": {
                            // Level 3: PASTA SAUCE STYLE
                            "Tomato-Based (Red)": {
                                "next_prompt": "4. Choose Combination/Protein Type:",
                                "options": {
                                    "Heavy Meat Ragu: (Beef, Wild Boar, Lamb)": {
                                        "result_specific": "Classic **Chianti Classico Riserva** (Tuscany, Sangiovese)",
                                        "result_general": "Excellent alternative: **Cabernet Sauvignon** (E.g., Chilean or Washington State)",
                                        "rationale": "The high acidity in Chianti cuts the fat of the heavy meat, while its firm tannins match the richness of the ragu. Cabernet Sauvignon is an excellent alternative because its high tannin and robust structure are universally known to pair well with heavy red meats."
                                    },
                                    "White Meat / Sausage: (Pork sausage, Veal, lighter meats)": {
                                        "result_specific": "**Aglianico del Vulture** (Basilicata) or **Montepulciano d'Abruzzo**",
                                        "result_general": "Excellent alternative: **Zinfandel** (Californian) or **C√¥tes du Rh√¥ne** (French Blend)",
                                        "rationale": "The best pairings offer a medium body and soft tannins, focusing on earthy/spicy notes that complement sausage fennel/spice. Zinfandel works because its dark, jammy fruit and spice notes are delicious with pork/sausage, and it typically has softer tannins than Cabernet."
                                    },
                                    "Vegetable-Forward: (Simple marinara with vegetables)": {
                                        "result_specific": "**Rosso di Montalcino** (Tuscany, Sangiovese) or **Dry Rosato** (Puglia)",
                                        "result_general": "Excellent alternative: **Pinot Noir** (Any region) or **Sauvignon Blanc** (New Zealand/Chile)",
                                        "rationale": "This requires high acidity to match the tomato but low tannins to avoid clashing with the lack of meat fat. Pinot Noir is a light-bodied, high-acid red that handles tomato beautifully."
                                    },
                                    "Spicy / Chili: (Arrabbiata, Puttanesca)": {
                                        "result_specific": "**Fiano di Avellino** (Campania) or **Dolcetto d'Alba** (Piedmont)",
                                        "result_general": "Excellent alternative: **Off-Dry Riesling** (Germany/Alsace) or **Gamay / Beaujolais** (France)",
                                        "rationale": "The key for spice is low alcohol and low tannin, as these elements magnify heat. Off-Dry Riesling (or a slightly sweeter white) is universally recommended for spice because the residual sugar calms the heat."
                                    },
                                    "Seafood / Light: (Quick-cooked tomato sauce with clams or mussels)": {
                                        "result_specific": "**Vermentino di Sardegna** (Sardinia) or **Falanghina** (Campania)",
                                        "result_general": "Excellent alternative: **Pinot Grigio** (Italy) or **Unoaked Chardonnay** (Chablis, etc.)",
                                        "rationale": "The high-acid, mineral/saline coastal Italian whites are perfect partners for seafood. Pinot Grigio is the most available and reliable choice, offering the required crispness and acid."
                                    }
                                }
                            },
                            "Cream/Butter/Cheese-Based": {
                                "next_prompt": "4. Choose Combination/Protein Type:",
                                "options": {
                                    "Robust Cheese: (Cacio e Pepe, heavy Pecorino/Parmigiano)": {
                                        "result_specific": "**Fiano di Avellino** (Campania) or **Verdicchio dei Castelli di Jesi Riserva** (Marche)",
                                        "result_general": "Excellent alternative: **Oaked Chardonnay** (Burgundy or California) or **White Rioja** (Spain)",
                                        "rationale": "The high savory, salty, and umami intensity of aged cheese requires a full-bodied white with good acid and texture. Oaked Chardonnay has the weight and savory notes to complement the richness, while its acidity cleanses the palate."
                                    },
                                    "Egg / Carbonara Style: (High egg/cured meat content)": {
                                        "result_specific": "**Frascati Superiore** (Lazio) or **Champagne / Franciacorta** (Brut)",
                                        "result_general": "Excellent alternative: **Dry Sparkling Wine** (Cava or Prosecco Brut)",
                                        "rationale": "Carbonara is extremely rich and high in fat. The bubbles and high acidity of a quality sparkling wine act as a palate cleanser, cutting through the dish's richness. Dry Champagne is the gold standard for high-fat dishes."
                                    },
                                    "Mushroom / Earthy: (Porcini, Truffles, or heavy funghi)": {
                                        "result_specific": "**Barolo** or **Barbaresco** (Piedmont, Nebbiolo) or Aged Nebbiolo",
                                        "result_general": "Excellent alternative: **Aged Pinot Noir** (Burgundy or Oregon) or **Medium-Dry Sherry** (Amontillado)",
                                        "rationale": "The earthy, complex flavors of mushrooms and truffles pair beautifully with the complex, tertiary notes of aged, savory red wines. Barolo is the regional match."
                                    },
                                    "Rich Meat / Game: (Cream sauce with pancetta, guanciale, or game)": {
                                        "result_specific": "**Barbera d'Asti** (Piedmont) or **Lagrein** (Alto Adige)",
                                        "result_general": "Excellent alternative: **Merlot** (Bordeaux or Washington State) or **Medium-Bodied Sangiovese**",
                                        "rationale": "The cream and meat require a red wine with very high acidity to cut the fat, but with soft, supple tannins that won't clash with the creamy texture. Barbera is famous for its bright acidity and soft tannins."
                                    },
                                    "Simple / Light Cream: (Simple butter sauce, light ricotta filling)": {
                                        "result_specific": "**Soave Classico** (Veneto) or **Gavi (Cortese)** (Piedmont)",
                                        "result_general": "Excellent alternative: **Pinot Grigio** (Alto Adige/Friuli) or **Unoaked White Blend** (E.g., Veltliner)",
                                        "rationale": "A simple, delicate sauce needs a crisp, unoaked white that is highly refreshing. Soave and Gavi offer light body, refreshing acidity, and a touch of almond/mineral quality."
                                    }
                                }
                            },
                            "Seafood-Based (Light)": {
                                "next_prompt": "4. Choose Combination/Protein Type:",
                                "options": {
                                    "Shellfish (Salty): (Vongole, Mussels, high-saline seafood)": {
                                        "result_specific": "**Vermentino di Sardegna** (Sardinia) or **Fiano di Avellino** (Campania)",
                                        "result_general": "Excellent alternative: **Albari√±o** (R√≠as Baixas, Spain) or **Sauvignon Blanc** (Sancerre, France)",
                                        "rationale": "The high salinity and fresh flavor of shellfish require a wine with sharp, refreshing acidity and intense minerality to harmonize with the ocean flavors. Albari√±o/Sancerre are universally available, high-acid whites with a similar crisp, mineral profile."
                                    },
                                    "Rich Fish / Calamari: (Tuna, swordfish, deep-fried calamari)": {
                                        "result_specific": "**Etna Bianco** (Sicily, Carricante) or **Grechetto** (Umbria)",
                                        "result_general": "Excellent alternative: **Pinot Gris** (Alsace) or **Unoaked Chardonnay** (Chablis, France)",
                                        "rationale": "Richer or fried fish needs a wine with slightly more body and texture to stand up to the fat. Pinot Gris and Unoaked Chardonnay offer that necessary structure and weight without overpowering the dish with oak."
                                    },
                                    "Lemon / Acidic: (Sauce heavily flavored with lemon/citrus)": {
                                        "result_specific": "**Falanghina** (Campania) or **Verdicchio dei Castelli di Jesi** (Marche)",
                                        "result_general": "Excellent alternative: **Sauvignon Blanc** (New Zealand) or **Dry Riesling** (Austria)",
                                        "rationale": "The wine must be as acidic as the dish's lemon/citrus to prevent the wine from tasting flat. Sauvignon Blanc and Dry Riesling are globally available, reliable high-acid choices."
                                    },
                                    "Herbaceous / Green: (Pesto with seafood, heavy parsley/basil)": {
                                        "result_specific": "**Gavi (Cortese)** (Piedmont) or **Soave Classico** (Veneto)",
                                        "result_general": "Excellent alternative: **Verdejo** (Spain) or **Sauvignon Blanc** (Chile)",
                                        "rationale": "Herbaceous flavors (especially pesto) require a wine that is unoaked and has 'green' or fresh herbal notes to match. Sauvignon Blanc and Verdejo are famous for their signature herbal and grassy aromas."
                                    },
                                    "Simple / Steamed: (Shrimp or fish simply poached/steamed)": {
                                        "result_specific": "**Pinot Grigio** (Alto Adige/Friuli) or **Prosecco (Brut)** (Veneto)",
                                        "result_general": "Excellent alternative: **Pinot Grigio** (Any region) or **Cava (Brut)** (Spain)",
                                        "rationale": "The simplest preparation needs the simplest, most refreshing pairing. High-quality Pinot Grigio is light, crisp, and refreshing."
                                    }
                                }
                            },
                            "Oil-Based / Garlic": {
                                "next_prompt": "4. Choose Combination/Flavor Type:",
                                "options": {
                                    "Garlic / Chili Heavy: (Aglio e Olio)": {
                                        "result_specific": "**Falanghina** (Campania) or **Verdicchio dei Castelli di Jesi** (Marche)",
                                        "result_general": "Excellent alternative: **Sauvignon Blanc** (New Zealand/Chile) or **Off-Dry Riesling** (Germany/Alsace)",
                                        "rationale": "The intense garlic and chili require a wine with high acidity and noticeable body/aromatics to cleanse the palate. Off-Dry Riesling is a fantastic choice because its slight sweetness is the best counterpoint for intense spice."
                                    },
                                    "Breadcrumbs / Nutty: (Pangrattato, walnuts, pine nuts)": {
                                        "result_specific": "**Fiano di Avellino** (Campania) or **Vernaccia di San Gimignano** (Tuscany)",
                                        "result_general": "Excellent alternative: **Oaked Chardonnay** (California or M√¢con, France) or **White Rioja** (Spain)",
                                        "rationale": "The nutty and savory/toasted texture works best with a white wine that has a similar texture or subtle savory complexity. Oaked Chardonnay is a great match because its subtle vanilla/nutty notes and fuller body complement the toasty element."
                                    },
                                    "Tomato / Olive: (Puttanesca [no heavy meat] or simple olives)": {
                                        "result_specific": "**Rosato (Ros√©)** from Abruzzo (Montepulciano d'Abruzzo based) or **Cerasuolo**",
                                        "result_general": "Excellent alternative: **Pinot Noir** (Any region) or **Dry Ros√©** (Provence, France)",
                                        "rationale": "This combination has the acidity of tomato, the salt of olives, and often savory/umami from capers. A savory, structured Italian Rosato is the perfect bridge. Pinot Noir is an excellent alternative red because its light body, high acid, and low tannins handle the savory tomato/olive flavor."
                                    },
                                    "Herbaceous / Green: (Oil with heavy oregano, parsley, or rosemary)": {
                                        "result_specific": "**Gavi (Cortese)** (Piedmont) or **Soave Classico** (Veneto)",
                                        "result_general": "Excellent alternative: **Sauvignon Blanc** (Sancerre, France) or **Verdejo** (Spain)",
                                        "rationale": "When fresh herbs are the dominant flavor, the wine should echo these 'green' and herbaceous notes. Sauvignon Blanc and Verdejo are world-renowned for their herbal, grassy, and citrus character."
                                    },
                                    "Simple / Minimal: (Pasta simply dressed with high-quality olive oil)": {
                                        "result_specific": "**Pinot Grigio** (Alto Adige/Friuli) or **Prosecco (Brut)** (Veneto)",
                                        "result_general": "Excellent alternative: **Pinot Grigio** (Any region) or **Soave Classico** (Veneto)",
                                        "rationale": "This delicate dish must not be overpowered. The wine should be light, neutral, and crisp to cleanse the palate and highlight the quality of the olive oil."
                                    }
                                }
                            },
                            "Stuffed Pasta (Richer)": {
                                "next_prompt": "4. Choose Combination/Filling Type:",
                                "options": {
                                    "Beef / Veal Filling: (Classic meat tortelli, Anolini)": {
                                        "result_specific": "**Barbera d'Asti** (Piedmont) or **Dolcetto d'Alba** (Piedmont)",
                                        "result_general": "Excellent alternative: **Merlot** (Bordeaux or Washington State) or **Chianti** (Tuscany)",
                                        "rationale": "The cooked red meat filling requires a savory, medium-bodied red with high acidity to cut the richness of the meat and the often butter-based sauce. Barbera and Dolcetto are regional classics."
                                    },
                                    "Game / Rich Meat: (Duck, Rabbit, Wild Boar filling)": {
                                        "result_specific": "**Pinot Noir** (Alto Adige/Trentino) or **Aglianico del Vulture** (Basilicata)",
                                        "result_general": "Excellent alternative: **Pinot Noir** (Oregon or Burgundy) or **Medium-bodied Zinfandel** (California)",
                                        "rationale": "Game meats require a wine that is slightly more complex, earthy, and aromatic, but not overly tannic. Pinot Noir is the classic choice for duck and other game birds due to its earthy notes."
                                    },
                                    "Rich Cheese / Cream: (Heavy ricotta/cheese filling, no spinach)": {
                                        "result_specific": "**Oaked Chardonnay** (Tuscany, Sicily, or Alto Adige) or **Verdicchio Riserva** (Marche)",
                                        "result_general": "Excellent alternative: **Oaked Chardonnay** (California or White Burgundy) or **White Rioja** (Spain)",
                                        "rationale": "The high-fat, rich dairy filling needs a full-bodied white wine with good structure and a creamy texture to match the food. Oaked Chardonnay provides the required weight."
                                    },
                                    "Light Vegetable / Herb: (Spinach/Ricotta, pumpkin/squash [non-sweet])": {
                                        "result_specific": "**Gavi (Cortese)** (Piedmont) or **Soave Classico** (Veneto)",
                                        "result_general": "Excellent alternative: **Sauvignon Blanc** (Sancerre, France) or **Pinot Grigio** (Friuli/Alto Adige)",
                                        "rationale": "Lighter vegetable fillings are delicate and often paired with butter/sage. The wine must be crisp, unoaked, and aromatic. Gavi is known for its fresh, subtle herbal notes."
                                    },
                                    "Sweet / Spice: (Sweet pumpkin/squash filling, e.g., Tortelli di Zucca)": {
                                        "result_specific": "**Lambrusco Amabile/Secco** (Emilia-Romagna) or **Recioto di Soave** (Veneto)",
                                        "result_general": "Excellent alternative: **Off-Dry Riesling** (Mosel, Germany) or **Dry Sparkling Ros√©** (Prosecco, Cava)",
                                        "rationale": "This is challenging, requiring a wine that can handle both the sweetness and often intense spice. A slightly sweet, sparkling Lambrusco is the perfect regional match. Off-Dry Riesling is the best alternative."
                                    }
                                }
                            }
                        }
                    },
                    "Risotto / Polenta": {
                        "user_label": "üçö Rice & Creamy Grains",
                        "next_prompt": "3. Choose Primary Base/Fat:",
                        "options": {
                            // Level 3: RISOTTO BASE/FAT
                            "Saffron / Butter": {
                                "next_prompt": "4. Choose Combination/Protein Type:",
                                "options": {
                                    "Ossobuco / Heavy Meat: (Rich, slow-cooked meat or jus)": {
                                        "result_specific": "**Barolo** (Piedmont, Nebbiolo) or **Valpolicella Ripasso** (Veneto)",
                                        "result_general": "Excellent alternative: **Cabernet Sauvignon** (Bordeaux or Napa Valley) or **Shiraz/Syrah** (Rh√¥ne Valley/Australia)",
                                        "rationale": "Ossobuco is a heavy, rich, savory dish. It requires a powerful, structured red wine with high tannins and enough body to stand up to the slow-cooked meat."
                                    },
                                    "Rich Bone Marrow: (Traditional Milanese style, very fatty)": {
                                        "result_specific": "**Franciacorta Brut** (Lombardy) or **Alto Adige Pinot Bianco** (Trentino)",
                                        "result_general": "Excellent alternative: **Dry Champagne** (Brut, Multi-Vintage) or **Unoaked Chardonnay** (Chablis)",
                                        "rationale": "High-fat dishes require a wine with extremely high acidity and/or effervescence to cut through the fat and cleanse the palate. Franciacorta is a perfect regional match."
                                    },
                                    "Mushroom / Earthy: (Porcini, truffles, or other earthy fungi)": {
                                        "result_specific": "**Barbaresco** (Piedmont, Nebbiolo) or **Older Chianti Classico** (Tuscany)",
                                        "result_general": "Excellent alternative: **Aged Pinot Noir** (Burgundy or Oregon) or **Medium-Dry Sherry** (Amontillado)",
                                        "rationale": "The savory, complex flavors of mushrooms and truffles pair beautifully with the tertiary notes (earth, leather, tobacco) of aged, savory red wines. Barbaresco is the regional match."
                                    },
                                    "Simple / Light Herbs: (Just butter/saffron, focus on pure flavor)": {
                                        "result_specific": "**Soave Classico** (Veneto) or **Gavi (Cortese)** (Piedmont)",
                                        "result_general": "Excellent alternative: **Pinot Grigio** (Friuli/Alto Adige) or **Dry Ros√©** (Provence, France)",
                                        "rationale": "This is a delicate dish that shouldn't be overpowered. It needs a very light, unoaked, high-acid white. Soave and Gavi are ideal, crisp Italian choices."
                                    },
                                    "Poultry / White Meat: (Chicken or veal pieces in the risotto)": {
                                        "result_specific": "**Lugana** (Veneto/Lombardy, Turbiana) or **Pinot Bianco** (Alto Adige)",
                                        "result_general": "Excellent alternative: **Viognier** (Rh√¥ne Valley/Australia) or **Oaked Chardonnay** (Macon or California)",
                                        "rationale": "White meat needs a slightly richer, more textural white wine than simple risotto. Lugana and Pinot Bianco have enough body and weight. Viognier and Oaked Chardonnay are excellent alternatives."
                                    }
                                }
                            },
                            "Rich Cheese / Cream": {
                                "next_prompt": "4. Choose Combination/Flavor Type:",
                                "options": {
                                    "Strong/Aged Cheese: (Gorgonzola, heavy Taleggio, Pecorino)": {
                                        "result_specific": "**Recioto di Soave** (Sweet, Veneto) or **Marsala Superiore** (Fortified)",
                                        "result_general": "Excellent alternative: **Sauternes** (Sweet Bordeaux) or **Off-Dry Riesling** (Germany)",
                                        "rationale": "The absolute best pairing for pungent blue/aged cheeses is often a contrasting sweet wine. The sweetness of the wine balances the cheese's salt and pungent notes."
                                    },
                                    "Butternut / Squash / Pumpkin: (Sweet-savory vegetable element)": {
                                        "result_specific": "**Arneis** (Piedmont) or **Pinot Grigio Ramato** (Friuli)",
                                        "result_general": "Excellent alternative: **Viognier** (Rh√¥ne Valley/Australia) or **Oaked Chardonnay** (Macon, France)",
                                        "rationale": "The subtle sweetness of squash requires a white wine with a round, textured body and aromatic intensity. Viognier offers a full body and notes of peach/apricot that harmonize well with sweet vegetables."
                                    },
                                    "Earthy / Truffle: (Truffles or intense truffle oil flavor)": {
                                        "result_specific": "**Aged Barolo** (Piedmont, Nebbiolo) or **Barbaresco**",
                                        "result_general": "Excellent alternative: **Aged Pinot Noir** (Burgundy or Oregon) or **Cru Beaujolais** (Morgon, Fleurie)",
                                        "rationale": "The distinct, savory umami of truffle and rich mushroom pairs best with aged red wines that exhibit tertiary, earthy aromas. Barolo/Barbaresco is the classic regional pairing."
                                    },
                                    "Game / Savory Meat: (Duck, Wild Boar, or heavy pancetta)": {
                                        "result_specific": "**Barbera d'Asti Superiore** (Piedmont) or **Lagrein** (Alto Adige)",
                                        "result_general": "Excellent alternative: **Merlot** (Bordeaux or Washington State) or **Medium-bodied Zinfandel** (California)",
                                        "rationale": "The high fat and savory nature of the meat demand a red wine with very high acidity to cut through the fat, and soft, approachable tannins. Barbera is famous for its bright acidity."
                                    },
                                    "Light Vegetable: (Asparagus, zucchini, or simple greens)": {
                                        "result_specific": "**Soave Classico** (Veneto) or **Verdicchio dei Castelli di Jesi** (Marche)",
                                        "result_general": "Excellent alternative: **Sauvignon Blanc** (Sancerre, France) or **Pinot Grigio** (Alto Adige/Friuli)",
                                        "rationale": "Lighter vegetables, especially asparagus which can be tricky, require a wine with high acidity and crisp, sometimes herbaceous notes. Sauvignon Blanc is an excellent alternative."
                                    }
                                }
                            },
                            "Vegetable Broth (Light)": {
                                "next_prompt": "4. Choose Combination/Vegetable Type:",
                                "options": {
                                    "Peas / Zucchini: (Simple, fresh, green vegetables)": {
                                        "result_specific": "**Soave Classico** (Veneto, Garganega) or **Gavi (Cortese)** (Piedmont)",
                                        "result_general": "Excellent alternative: **Pinot Grigio** (Alto Adige/Friuli) or **Sauvignon Blanc** (Chile)",
                                        "rationale": "These light, fresh green vegetables pair best with crisp, unoaked whites that have a slightly neutral profile, letting the vegetable flavor shine. Soave and Gavi are dry, high-acid Italian classics."
                                    },
                                    "Asparagus / Artichoke: (Vegetables with bitter or distinct flavor)": {
                                        "result_specific": "**Sauvignon Blanc** (Alto Adige, Italy) or **Verdicchio dei Castelli di Jesi** (Marche)",
                                        "result_general": "Excellent alternative: **Sauvignon Blanc** (Sancerre/New Zealand) or **Dry Riesling** (Austria)",
                                        "rationale": "Asparagus and artichoke contain compounds that can make dry, tannic, or high-alcohol wines taste metallic or bitter. The best pairing is a highly acidic white with a natural affinity for 'green' flavors."
                                    },
                                    "Herb Pesto / Basil: (Strong presence of green herbs, not cream)": {
                                        "result_specific": "**Vermentino di Sardegna** (Sardinia) or **Gavi (Cortese)** (Piedmont)",
                                        "result_general": "Excellent alternative: **Sauvignon Blanc** (Sancerre, France) or **Verdejo** (Spain)",
                                        "rationale": "The intense, aromatic green herbs require a wine that can match this aromatic intensity. Vermentino and Gavi offer that aromatic complexity with good acidity."
                                    },
                                    "Tomato / Red Pepper: (Lightly colored with red vegetables)": {
                                        "result_specific": "**Rosato (Ros√©)** from Abruzzo (Cerasuolo style) or **Bardolino** (Veneto)",
                                        "result_general": "Excellent alternative: **Dry Ros√©** (Provence, France) or **Gamay / Beaujolais** (France)",
                                        "rationale": "The tomato and red pepper introduce a degree of acidity and subtle sweetness that is best matched by a high-acid, versatile wine. Gamay (Beaujolais) is an ideal light red alternative‚Äîhigh acid, low tannin, and served slightly cool."
                                    },
                                    "Legumes / Beans: (Lentils or hearty bean component)": {
                                        "result_specific": "**Chianti** (Tuscany, Sangiovese) or **Bardolino** (Veneto)",
                                        "result_general": "Excellent alternative: **Pinot Noir** (Any region) or **Medium-bodied Merlot** (Chile)",
                                        "rationale": "The hearty texture and earthiness of lentils and beans require a little more body than simple greens. Chianti is the classic match for beans due to its high acidity and savory character."
                                    }
                                }
                            },
                            "Tomato / Red Wine Base": {
                                "next_prompt": "4. Choose Combination/Protein Type:",
                                "options": {
                                    "Heavy Meat / Game: (Beef, Wild Boar, Salsiccia)": {
                                        "result_specific": "**Barolo** or **Barbaresco** (Piedmont, Nebbiolo) or **Chianti Classico Riserva** (Tuscany)",
                                        "result_general": "Excellent alternative: **Cabernet Sauvignon** (Napa or Bordeaux) or **Shiraz/Syrah** (Australia/Rh√¥ne)",
                                        "rationale": "This is the heaviest combination. It requires a powerful, structured red wine with high acidity (to match the tomato/red wine base) and high tannins (to cut through the richness of the meat/sausage). Barolo and Chianti Classico fit this profile perfectly."
                                    },
                                    "Poultry / White Meat: (Chicken, Veal)": {
                                        "result_specific": "**Aglianico del Vulture** (Basilicata) or **Montepulciano d'Abruzzo**",
                                        "result_general": "Excellent alternative: **Zinfandel** (California) or **Merlot** (Bordeaux/Chile)",
                                        "rationale": "This needs a red wine with excellent acidity to handle the tomato and richness, but with softer, more supple tannins that won't overpower the poultry/veal. Aglianico and Montepulciano are medium-bodied, savory reds."
                                    },
                                    "Seafood / Robust Fish: (Tuna, swordfish, heavy fish stock)": {
                                        "result_specific": "**Etna Rosso** (Sicily, Nerello Mascalese) or **Rosso di Montalcino** (Tuscany)",
                                        "result_general": "Excellent alternative: **Pinot Noir** (Oregon/Burgundy) or **Dry Rosato** (Puglia)",
                                        "rationale": "This combination requires a light-bodied, savory, high-acid red with very low tannins. Etna Rosso is a high-acid, savory red that handles both the tomato and the meaty texture of tuna/swordfish well."
                                    },
                                    "Vegetarian / Simple: (Just tomato and/or basic vegetables)": {
                                        "result_specific": "**Bardolino** (Veneto) or **Valpolicella Classico** (Veneto)",
                                        "result_general": "Excellent alternative: **Pinot Noir** (Any region) or **Gamay / Beaujolais** (France)",
                                        "rationale": "The simple, savory tomato base needs a high-acid, low-tannin red that can be served slightly cool. Bardolino and Valpolicella are perfect regional choices."
                                    },
                                    "Spicy / Chili: (Arriving with a noticeable kick of heat)": {
                                        "result_specific": "**Dolcetto d'Alba** (Piedmont) or **Lagrein** (Alto Adige)",
                                        "result_general": "Excellent alternative: **Zinfandel** (California) or **Cru Beaujolais** (France)",
                                        "rationale": "The presence of spice mandates a wine that is low in alcohol and tannin. Dolcetto is a fruity red with soft tannins and moderate alcohol. Zinfandel is a great counterpoint."
                                    }
                                }
                            },
                            "Seafood Broth (Robust)": {
                                "next_prompt": "4. Choose Combination/Flavor Type:",
                                "options": {
                                    "Black Ink (Nero di Seppia): (Dark, rich, and intensely savory)": {
                                        "result_specific": "**Vermentino di Sardegna** (High Quality) or **Etna Bianco** (Sicily, Carricante)",
                                        "result_general": "Excellent alternative: **S√©millon** (Australia/Bordeaux) or **Sauvignon Blanc** (Fum√© Blanc style)",
                                        "rationale": "The savory, rich, and slightly metallic flavor of black ink requires a white wine with substantial body, structure, and high acidity to cut the richness. S√©millon offers a round texture and ability to age, matching the dish's complexity."
                                    },
                                    "Shellfish (Salty): (Clams/Vongole, Mussels, high-saline seafood)": {
                                        "result_specific": "**Greco di Tufo** (Campania) or **Verdicchio dei Castelli di Jesi Riserva** (Marche)",
                                        "result_general": "Excellent alternative: **Albari√±o** (R√≠as Baixas, Spain) or **Sauvignon Blanc** (Sancerre, France)",
                                        "rationale": "The intense salinity of shellfish demands a bone-dry, high-acid white with pronounced minerality. Greco di Tufo is a complex, high-acid Southern Italian white."
                                    },
                                    "Rich Fish / Shrimp: (Tuna, Monkfish, large prawns)": {
                                        "result_specific": "**Lugana** (Veneto/Lombardy, Turbiana) or **Fiano di Avellino** (Campania)",
                                        "result_general": "Excellent alternative: **Viognier** (Rh√¥ne Valley/Australia) or **Oaked Chardonnay** (Chablis Premier Cru or Burgundy)",
                                        "rationale": "Rich, meaty fish and large prawns require a white wine with more texture and body to match the food's weight. Viognier offers a fuller body and round texture."
                                    },
                                    "Tomato / Light Red: (Seafood base with a tomato component)": {
                                        "result_specific": "**Etna Rosso** (Sicily, Nerello Mascalese) or **Rosato (Ros√©) del Salento** (Puglia)",
                                        "result_general": "Excellent alternative: **Pinot Noir** (Any region) or **Dry Ros√©** (Bandol or Tavel, France)",
                                        "rationale": "The tomato introduces high acidity, which is difficult for white wines. Etna Rosso is one of the few high-acid red wines that handles seafood/tomato well."
                                    },
                                    "Spicy / Pepper: (With a noticeable heat/pepper flakes)": {
                                        "result_specific": "**Gew√ºrztraminer** (Alto Adige/Friuli) or **Falanghina** (Campania)",
                                        "result_general": "Excellent alternative: **Off-Dry Riesling** (Mosel, Germany) or **Dry Sparkling Wine** (Prosecco)",
                                        "rationale": "Spice must be met with low alcohol/tannin and often a touch of sweetness to soothe the heat. Gew√ºrztraminer is the classic spice pairing due to its aromatic intensity and lower acid/alcohol."
                                    }
                                }
                            }
                        }
                    },
                    "Grilled / Roasted Meats": {
                        "user_label": "ü•© Main Meats (Secondi)",
                        "next_prompt": "3. Choose Type of Meat / Cut:",
                        "options": {
                            // Level 3: MEAT TYPE / CUT
                            "Red Meat (Beef/Lamb)": {
                                "next_prompt": "4. Choose Combination/Preparation Style:",
                                "options": {
                                    "Simple Seasoning / Grill: (Bistecca alla Fiorentina)": {
                                        "result_specific": "**Chianti Classico Riserva** (Tuscany, Sangiovese) or **Barolo/Barbaresco** (Piedmont)",
                                        "result_general": "Excellent alternative: **Cabernet Sauvignon** (Napa or Bordeaux) or **Malbec** (Argentina)",
                                        "rationale": "Simple preparation means the focus is on the meat's quality and fat. This demands a high-tannin, high-acid red wine. The tannins bind to the meat's protein and fat, cleansing the palate. Chianti is the perfect regional match for Bistecca."
                                    },
                                    "Rich Red Wine Reduction: (Heavy sauce or glaze)": {
                                        "result_specific": "**Amarone della Valpolicella** (Veneto) or **Super Tuscan** (Sangiovese/Cabernet Blend)",
                                        "result_general": "Excellent alternative: **Cabernet Franc** (Loire Valley or Washington) or **Aged Merlot** (Pomerol style)",
                                        "rationale": "The reduction sauce requires a wine with immense body and concentrated flavor, often with high alcohol, to stand up to the glaze. Amarone has the power and concentration to match."
                                    },
                                    "Herb Crust / Garlic: (Heavy rosemary, thyme, or garlic)": {
                                        "result_specific": "**Aglianico del Vulture** (Basilicata) or **Taurasi** (Campania)",
                                        "result_general": "Excellent alternative: **Syrah/Shiraz** (Rh√¥ne Valley or Australia) or **Priorat** (Spain)",
                                        "rationale": "The intense, savory flavors of rosemary and garlic need a wine with a strong savory, peppery, or herbal backbone. Syrah is the perfect global choice, as its classic profile includes savory, pepper, and herbaceous notes that harmonize with the seasoning."
                                    },
                                    "Fatty Cut: (Ribeye/Costata, high marbling)": {
                                        "result_specific": "**Barolo** (Piedmont, Nebbiolo) or **Sagrantino di Montefalco** (Umbria)",
                                        "result_general": "Excellent alternative: **Cabernet Sauvignon** (Napa or Coonawarra) or **Tannat** (Uruguay/Madiran)",
                                        "rationale": "High fat requires the highest level of tannin to efficiently cleanse the palate. Barolo and Sagrantino are some of Italy's most tannic wines. The fat softens the wine's harshness and the wine cuts through the richness."
                                    },
                                    "Acidity / Citrus: (Lemon zest, or a light vinegar reduction)": {
                                        "result_specific": "**Barbera d'Asti Superiore** (Piedmont) or **Valpolicella Ripasso** (Veneto)",
                                        "result_general": "Excellent alternative: **Pinot Noir** (Oregon or Burgundy) or **Light-bodied Sangiovese** (Chianti)",
                                        "rationale": "When high acidity is present in the sauce/seasoning, the wine must have high acidity, but it often needs softer tannins to avoid clashing. Barbera is famous for its very bright acidity and soft tannins."
                                    }
                                }
                            },
                            "White Meat (Pork/Veal)": {
                                "next_prompt": "4. Choose Combination/Preparation Style:",
                                "options": {
                                    "Cream / Butter Sauce: (Heavy pan sauce, e.g., scaloppine)": {
                                        "result_specific": "**Lugana** (Veneto/Lombardy, Turbiana) or **Oaked Vernaccia di San Gimignano** (Tuscany)",
                                        "result_general": "Excellent alternative: **Oaked Chardonnay** (California or Burgundy) or **Viognier** (Rh√¥ne Valley)",
                                        "rationale": "The richness of the cream and butter sauce requires a full-bodied white wine with good acidity and texture. Oaked Chardonnay provides the necessary weight and structure, while its acidity cuts through the fat to cleanse the palate."
                                    },
                                    "Herb-Crusted / Roasted: (Heavy rosemary/sage seasoning, e.g., Arrosto)": {
                                        "result_specific": "**Chianti Rufina** (Tuscany, Sangiovese) or **Barbera d'Asti** (Piedmont)",
                                        "result_general": "Excellent alternative: **Pinot Noir** (Oregon/Burgundy) or **Cru Beaujolais** (France, Gamay)",
                                        "rationale": "The aromatic herbs (rosemary/sage) pair beautifully with savory, earthy, and high-acid reds. The acidity of Chianti and Barbera complements the roasted meat. Pinot Noir and Beaujolais are perfect alternatives: light enough for the white meat, but savory enough for the herbs."
                                    }
                                    // NOTE: Data stops here for this branch, but the JS handles it gracefully.
                                }
                            }
                            // NOTE: Data stops here for this branch, but the JS handles it gracefully.
                            // ... Add Game Meat, Offal / Rich Cuts, and Poultry pairings here ...
                        }
                    },
                    "Grilled Fish / Light Dishes": {
                        "user_label": "üêü Light Fish & Seafood",
                        "next_prompt": "3. Choose Fish Texture / Fat Content:",
                        "options": {
                            // Level 3: FISH TEXTURE / FAT CONTENT
                            "Lean White Fish": {
                                "next_prompt": "4. Choose Combination/Flavor Profile:",
                                "options": {
                                    // ... Fish Pairings here ...
                                }
                            },
                            "Medium-Fat Fish": {
                                "next_prompt": "4. Choose Combination/Flavor Profile:",
                                "options": {
                                    // ... Fish Pairings here ...
                                }
                            }
                            // NOTE: Data stops here for this branch, but the JS handles it gracefully.
                            // ... Add Oily Fish, Shellfish, and Light Vegetable/Salad pairings here ...
                        }
                    },
        "Appetizers & Pizza": {
            "user_label": "üçï Appetizers & Pizza",
            "next_prompt": "3. Choose Preparation/Focus:",
            "options": {
                "Pizza - Classic / Simple": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Simple / Neutral: (Margherita or simple Napoletana)": { "result_specific": "Lambrusco Grasparossa di Castelvetro Secco (Emilia-Romagna) or Valpolicella Classico (Veneto)", "result_general": "Dry Sparkling Ros√© (Prosecco, Cava) or Pinot Noir (Any region)", "rationale": "The high acidity of the tomato demands a high-acid wine with light body and low tannins. Lambrusco Secco (dry, fizzy red) is the ultimate, refreshing, palate-cleansing regional match. Pinot Noir and Dry Sparkling Ros√© are excellent alternatives that deliver the required acidity without clashing with the subtle flavors." },
                        "High Spice / Chili: (Diavola or crushed red pepper)": { "result_specific": "Dolcetto d'Alba (Piedmont) or Aglianico del Vulture (Basilicata)", "result_general": "Zinfandel (California) or Off-Dry Riesling (Germany/Alsace)", "rationale": "Spice needs wines that are low in alcohol/tannin (to avoid amplifying heat) and often slightly fruity. Dolcetto is a soft, fruity, low-tannin red. Off-Dry Riesling is the global classic for spice, as its touch of sweetness calms the heat, while Zinfandel's bold fruit works well with rich, spicy meat (like pepperoni)." },
                        "Savory / Anchovy: (Napoli style, with high salt/umami from anchovies)": { "result_specific": "Rosato (Ros√©) del Salento (Puglia) or Greco di Tufo (Campania)", "result_general": "Albari√±o (R√≠as Baixas, Spain) or Manzanilla Sherry (Spain)", "rationale": "The intense salt and umami of anchovies need a high-acid, savory wine with a strong mineral backbone. Italian Rosato is a perfect savory, structured choice. Albari√±o and Manzanilla Sherry (dry, savory, and highly saline) are globally recognized, excellent pairings for high-salt seafood." },
                        "Rich Cheese / Buffalo: (Mozzarella di Bufala, higher fat content)": { "result_specific": "Fiano di Avellino (Campania) or Lugana (Veneto/Lombardy)", "result_general": "Unoaked Chardonnay (Chablis, France) or Sauvignon Blanc (Sancerre, France)", "rationale": "The higher fat content of Buffalo Mozzarella requires a white wine with more body and structure to match the richness. Fiano offers the required weight and acidity. Unoaked Chardonnay provides enough body and structure to handle the creamy texture without clashing with the tomato." }
                    }
                },
                "Pizza - Meat / Salumi": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Cured / Spicy: (Pepperoni, spicy Salami, high fat and spice)": { "result_specific": "Aglianico del Vulture (Basilicata) or Primitivo (Puglia)", "result_general": "Zinfandel (California) or Syrah/Shiraz (Rh√¥ne Valley/Australia)", "rationale": "The high fat, salt, and spice demand a bold, fruity red with enough structure and acidity. Primitivo (Zinfandel) is the perfect regional match‚Äîits jammy fruit and spice notes are delicious with cured meat. Zinfandel and Syrah are excellent alternatives that can handle the intensity and richness." },
                        "Cooked / Savory: (Prosciutto Cotto, Ham, less spice, more savory)": { "result_specific": "Valpolicella Ripasso (Veneto) or Chianti Classico (Tuscany)", "result_general": "Merlot (Bordeaux/Chile) or Sangiovese (General Italian)", "rationale": "Cooked ham is savory but less fatty than cured meat. It needs a high-acid, medium-bodied red. Ripasso offers concentrated savory fruit, while Chianti provides high acid and structure. Merlot is a widely available, soft-tannin, medium-bodied red that pairs beautifully with savory cooked ham." },
                        "Sausage / Fennel: (Ground pork sausage, often with fennel/herb spice)": { "result_specific": "Aglianico del Vulture (Basilicata) or Montepulciano d'Abruzzo", "result_general": "Zinfandel (California) or Cru Beaujolais (France, Gamay)", "rationale": "The distinctive fennel/herb spice in Italian sausage requires a savory red wine with good acidity and structure. Aglianico and Montepulciano are classic, savory Italian reds. Zinfandel's jammy, spicy notes are a traditional and excellent complement to pork and fennel sausage." },
                        "Rich Cheese Added: (Gorgonzola or strong Pecorino)": { "result_specific": "Barbera d'Asti Superiore (Piedmont) or Aglianico (Basilicata)", "result_general": "Oaked Chardonnay (California/Burgundy) or Full-bodied Zinfandel (California)", "rationale": "The pungent, intense flavor of Gorgonzola/Pecorino needs a wine with strong acidity (to cut the fat) and enough flavor intensity to match the cheese. Barbera offers excellent acidity. Oaked Chardonnay is a great white alternative, providing the necessary body and savory notes. Zinfandel, in this case, would stand up to the intensity of the cheese." }
                    }
                },
                "Pizza - Vegetable / Herb": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Heavy Cheese / Cream: (Quattro Formaggi, Taleggio, or strong white sauce)": { "result_specific": "Fiano di Avellino (Campania) or Oaked Vernaccia di San Gimignano (Tuscany)", "result_general": "Oaked Chardonnay (Burgundy or California) or White Rioja (Spain)", "rationale": "The intense fat and savory flavor of the multiple rich cheeses demand a full-bodied white wine with structure and good acidity. Fiano offers the required weight and acidity. Oaked Chardonnay is a perfect global alternative, as its texture and savory, subtle nutty notes complement the rich cheese." },
                        "Potato / Rosemary: (Simple, savory, high-starch base)": { "result_specific": "Lugana (Veneto/Lombardy, Turbiana) or Pinot Bianco (Alto Adige)", "result_general": "Pinot Gris (Alsace) or Pinot Grigio (Friuli/Alto Adige)", "rationale": "The high-starch and subtle aromatic rosemary require a crisp, dry white with good body to match the potato's weight. Lugana and Pinot Bianco are excellent structural whites. Pinot Gris (Alsace) offers the needed body and sometimes subtle spice that complements the rosemary." },
                        "Earthy / Truffle: (Truffle oil, Porcini mushrooms, or earthy greens)": { "result_specific": "Aged Barolo or Barbaresco (Piedmont, Nebbiolo) or Older Chianti Classico (Tuscany)", "result_general": "Aged Pinot Noir (Burgundy or Oregon) or Cru Beaujolais (France, Gamay)", "rationale": "The distinct, savory truffle and earthy mushroom flavors are best matched by the complex, savory, tertiary notes of aged, high-quality red wines. Barolo is the classic regional match. Aged Pinot Noir is the excellent global alternative, sharing the necessary complexity and soft tannins." },
                        "Herb Pesto / Green: (Strong basil, arugula, or green sauce base)": { "result_specific": "Gavi (Cortese) (Piedmont) or Vermentino di Sardegna (Sardinia)", "result_general": "Sauvignon Blanc (Sancerre/New Zealand) or Verdejo (Spain)", "rationale": "The intense, aromatic green herbs require a wine with complementary herbaceous and citrus notes, and high acidity. Gavi and Vermentino are crisp, aromatic Italian whites. Sauvignon Blanc is the global benchmark, with its classic 'green' and grassy notes perfectly matching basil and arugula." }
                    }
                },
                "Pizza - Seafood": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Shellfish / Salty: (Vongole, Mussels, high salinity)": { "result_specific": "Vermentino di Sardegna (Sardinia) or Greco di Tufo (Campania)", "result_general": "Albari√±o (R√≠as Baixas, Spain) or Muscadet S√®vre et Maine (Loire Valley)", "rationale": "The high salinity of the shellfish demands a bone-dry, high-acid white wine with intense minerality. Vermentino is the classic, structured coastal white. Albari√±o is an excellent alternative, offering high acid and a slight savory component perfect for clams and mussels." },
                        "Shrimp / Zucchini: (Light, delicate seafood/vegetable combination)": { "result_specific": "Soave Classico (Veneto, Garganega) or Gavi (Cortese) (Piedmont)", "result_general": "Pinot Grigio (Alto Adige/Friuli) or Sauvignon Blanc (Sancerre, France)", "rationale": "This delicate, light topping requires a crisp, unoaked white that won't overpower the subtle flavors. Soave and Gavi are ideal light-bodied Italian matches. Pinot Grigio is the most widely available, reliable, neutral choice to complement the delicacy of shrimp and zucchini." },
                        "Lemon / Citrus: (Sauce or seasoning with pronounced lemon/citrus)": { "result_specific": "Verdicchio dei Castelli di Jesi (Marche) or Falanghina (Campania)", "result_general": "Sauvignon Blanc (New Zealand/Chile) or Dry Riesling (Austria)", "rationale": "The wine must match the high acidity of the lemon/citrus seasoning to prevent the wine from tasting flat. Verdicchio and Falanghina are excellent Italian high-acid whites. Sauvignon Blanc is a globally available, highly acidic option that complements citrus and herbaceous notes perfectly." },
                        "Herbaceous / Garlic: (Heavy parsley/garlic, e.g., in a Vongole topping)": { "result_specific": "Gavi (Cortese) (Piedmont) or Vermentino di Sardegna (Sardinia)", "result_general": "Sauvignon Blanc (Sancerre, France) or Verdejo (Spain)", "rationale": "The high concentration of green herbs and garlic demands an unoaked, highly aromatic white wine. Gavi and Vermentino offer the necessary acidity and aromatic intensity. Sauvignon Blanc is the ideal global match, known for its complementary herbal and citrus aromas." }
                    }
                },
                "Apparativo": {
                    "next_prompt": "4. Choose Focus:",
                    "options": {
                        "Cured Meat Focus: (Heavy prosciutto, salami, or coppa, high fat/salt)": { "result_specific": "Lambrusco Grasparossa di Castelvetro Secco (Emilia-Romagna) or Sangiovese Rosato (Tuscany)", "result_general": "Dry Sparkling Ros√© (Prosecco, Cava) or Cru Beaujolais (France, Gamay)", "rationale": "The high fat and salt of cured meats demand a wine that is high-acid, savory, and extremely refreshing. Dry Lambrusco is the ultimate regional choice‚Äîits bubbles and high acidity cut the fat brilliantly. Sparkling Ros√© or a light, high-acid, savory red like Beaujolais are excellent, versatile alternatives." },
                        "Cheese & Nut Focus: (Hard cheese, walnuts, almonds)": { "result_specific": "Verdicchio dei Castelli di Jesi Riserva (Marche) or Fiano di Avellino (Campania)", "result_general": "Oaked Chardonnay (Burgundy or California) or Sauvignon Blanc (Sancerre, France)", "rationale": "The savory, nutty, and slightly umami flavors of hard cheese and nuts pair well with structured, full-bodied white wines. Verdicchio Riserva and Fiano offer the necessary texture and complexity. Oaked Chardonnay is a great alternative, providing a complementary creamy/nutty texture and good acidity." },
                        "Olive / Pickle Focus: (Heavy marinated olives, artichokes, high brine/acid)": { "result_specific": "Verdicchio dei Castelli di Jesi (Marche) or Falanghina (Campania)", "result_general": "Dry Sherry (Fino/Manzanilla) (Spain) or Sauvignon Blanc (Sancerre, France)", "rationale": "The high brine, acid, and sometimes bitter flavors of olives and pickles are notoriously difficult. The wine must be highly acidic and unoaked. Verdicchio and Falanghina are superb Italian matches. Fino Sherry is the ultimate savory/salty pairing, while Sauvignon Blanc is the most reliable high-acid white for handling bitterness and herbs." },
                        "Simple Bread / Focaccia: (Simple bread, grissini, focus on texture)": { "result_specific": "Prosecco (Brut) (Veneto) or Gavi (Cortese) (Piedmont)", "result_general": "Dry Sparkling Wine (Cava or M√©thode Traditionnelle) or Pinot Grigio (Alto Adige)", "rationale": "Simple textures and minimal flavor need a wine that is light, crisp, and highly refreshing. Prosecco is the perfect palate cleanser and regional choice. Any high-quality Dry Sparkling Wine or a crisp, light Pinot Grigio will refresh the palate without overwhelming the delicate flavors." }
                    }
                }
            }
        }
    }
},
"French": {
    "title": "French Cuisine üá´üá∑",
    "emoji": "üá´üá∑",
    "next_prompt": "2. Choose Initial Category:",
    "options": {
        // LEVEL 1: Red Meat & Game
        "Red Meat & Game": {
            "user_label": "ü•© Red Meat & Game",
            "next_prompt": "3. Choose Preparation/Seasoning:",
            "options": {
                // LEVEL 2: Grilled / Roasted (Simple Seasoning)
                "Grilled / Roasted (Simple Seasoning)": {
                    "next_prompt": "4. Choose Cut/Seasoning Detail:",
                    "options": {
                        "High Fat Cut (Ribeye, T-Bone) / Heavy Seasoning": { "result_specific": "Pauillac, Bordeaux (Cabernet Sauvignon)", "result_general": "New World Cabernet Sauvignon (Napa Valley, Coonawarra)", "rationale": "The immense structure, firm tannins, and high acidity of top Left Bank Bordeaux (Pauillac) are essential to cut through the high fat content of the ribeye, while the wine's powerful black fruit and oak match the heavy seasoning and the charred crust of the grill. New World Cabernets offer similar tannin structure and body." },
                        "Lean Cut (Filet, Sirloin) / Light Seasoning": { "result_specific": "Chambolle-Musigny, Burgundy (Pinot Noir)", "result_general": "Oregon or Sonoma Coast Pinot Noir", "rationale": "Leaner cuts and lighter seasoning require a more delicate, less aggressive wine. Burgundy Pinot Noir's hallmark is its high acidity, silky texture, and delicate earthy notes, which complement the meat without overpowering it. Pinot Noir from cooler New World regions offers similar finesse and acidity." },
                        "Herb-Crusted / Aromatic Rubs (Rosemary, Thyme)": { "result_specific": "Chinon, Loire Valley (Cabernet Franc)", "result_general": "Southern Italian Primitivo / Zinfandel", "rationale": "The distinct herbaceous and often slightly 'green' note (pyrozines) of Cabernet Franc harmonizes perfectly with the rosemary, thyme, and other aromatics in the crust. Its medium body and firm structure stand up to the meat. Primitivo/Zinfandel, especially from Southern Italy, often exhibits similar earthy/herbal spice notes." },
                        "Smokey / Wood-Fired Preparation": { "result_specific": "Hermitage, Northern Rh√¥ne (Syrah)", "result_general": "Australian Shiraz or Syrah-based blend (e.g., California/Washington)", "rationale": "The smoky, peppery, and meaty notes inherent in Northern Rh√¥ne Syrah (Hermitage) mirror and amplify the char and smoke flavor imparted by the wood-fired cooking method. The wine's bold flavor and substantial structure stand up to the intensity of the smoke. Australian Shiraz offers equivalent power and spice." },
                        "Served Rare / Cool Center": { "result_specific": "Morgon, Beaujolais Cru (Gamay)", "result_general": "Light-Bodied, Chilled Red (e.g., Loire Ros√© or Grenache)", "rationale": "A rare/cool center requires a wine with bright acidity and juicy, refreshing fruit, often served slightly chilled. Morgon is a structured Beaujolais Cru with bright red fruit, high acidity, and minimal tannin, making it perfect for pairing with the cold protein without introducing clashing tannins." }
                    }
                },
                // LEVEL 2: Sauce au Vin (e.g., Reduction/Bordelaise)
                "Sauce au Vin (e.g., Reduction/Bordelaise)": {
                    "next_prompt": "4. Choose Sauce Detail:",
                    "options": {
                        "Very Reduced / Glazed / Concentrated": { "result_specific": "Pomerol, Bordeaux (Merlot-Dominant)", "result_general": "Aged Super Tuscan (Sangiovese/Cabernet Blend)", "rationale": "A very reduced, concentrated sauce mirrors the texture and complexity of an aged wine. Pomerol's luscious, plush texture and notes of plum and cedar complement the richness without the aggressive tannins of a younger Left Bank wine. An aged Super Tuscan offers similar depth and soft tannins." },
                        "Mushroom / Truffle Infusion in Sauce": { "result_specific": "Volnay, Burgundy (Mature Pinot Noir)", "result_general": "Barolo or Barbaresco (Piedmont, Nebbiolo)", "rationale": "Both the sauce and the ideal wine are defined by earthiness and savoriness (umami). A mature Volnay (or similar earthy Burgundy) provides the delicate tertiary notes of forest floor and dried leaves that harmonize perfectly with mushroom and truffle without overwhelming the meat. Nebbiolo offers a structured, complex alternative with strong earthy notes." },
                        "Tomato-Based / High Acidity Reduction": { "result_specific": "Saumur-Champigny, Loire Valley (Cabernet Franc)", "result_general": "Chianti Classico (Tuscany, Sangiovese)", "rationale": "The acidity of the tomato requires a red wine with similarly high natural acidity to avoid making the wine taste flat or sweet. Loire Cabernet Franc is naturally high in acid and often has a leaner structure, making it ideal for the tomato base. Chianti is a universal pairing for Italian tomato sauces and works well here too." },
                        "Rich Butter / Marrow Emulsion": { "result_specific": "St-√âmilion Grand Cru, Bordeaux (Merlot/Cabernet Franc)", "result_general": "New World Merlot (e.g., Washington State)", "rationale": "The rich, unctuous texture of butter or marrow requires a wine with roundness, polished tannins, and weight to match the mouthfeel. St-√âmilion's Merlot dominance provides this softness and richness, seamlessly blending with the sauce's texture. A quality New World Merlot provides reliable fruit and body." },
                        "Sweetened / Dark Fruit Compote in Sauce": { "result_specific": "Ch√¢teauneuf-du-Pape, Southern Rh√¥ne", "result_general": "Amarone della Valpolicella (Veneto)", "rationale": "The slight sweetness and dark fruit (e.g., fig, cherry, currant) in the sauce require a wine with intense, concentrated fruit flavors and high alcohol, which reads as an appropriate counter-weight to the sugar. Ch√¢teauneuf-du-Pape's rich, spicy, and often high-alcohol profile is perfect. Amarone provides similar power and dried-fruit intensity." }
                    }
                },
                // LEVEL 2: Rich Cream / Mushroom Sauce
                "Rich Cream / Mushroom Sauce": {
                    "next_prompt": "4. Choose Sauce Detail:",
                    "options": {
                        "Heavy Cream / Cr√®me Fra√Æche Base": { "result_specific": "Meursault, Burgundy (Oaked Chardonnay)", "result_general": "High-Quality Oaked Chardonnay (e.g., California, South Africa)", "rationale": "The rich, viscous texture of a heavy cream sauce needs a wine with equivalent body and structure to prevent the wine from tasting thin. Meursault's full body, buttery texture, and balancing acidity are perfect textural complements. A high-quality New World Oaked Chardonnay serves the same purpose with its rich mouthfeel." },
                        "Porcini / Truffle / Highly Earthy Mushrooms": { "result_specific": "Gevrey-Chambertin, Burgundy (Mature Pinot Noir)", "result_general": "Piedmont Nebbiolo (e.g., Langhe Nebbiolo)", "rationale": "Truffles and intense wild mushrooms amplify the savory, 'forest floor' notes in mature red wines. Gevrey-Chambertin, known for its powerful, earthy structure, has the complexity and tertiary flavors to stand up to the umami bomb of truffles/porcini. Nebbiolo is the primary Italian red with similar deep, earthy structure." },
                        "Light Sauce / Button or Cultivated Mushrooms": { "result_specific": "Savigny-l√®s-Beaune, Burgundy (Pinot Noir)", "result_general": "Valpolicella Classico (Corvina, Rondinella, etc.)", "rationale": "A lighter sauce requires a lighter, more delicate wine. Savigny-l√®s-Beaune offers the classic earthy complexity of Burgundy but with a gentler, medium-body and softer structure, avoiding the need for a powerhouse wine. Valpolicella is a classic Italian choice for lighter meats and earthy flavors, providing fruit and soft tannins." },
                        "Herb-Focused Cream Sauce (Tarragon, Chervil)": { "result_specific": "Condrieu, Northern Rh√¥ne (Viognier)", "result_general": "Oaked Marsanne / Roussanne Blend", "rationale": "The distinct aromas of tarragon and chervil demand a highly aromatic, slightly oily white wine to harmonize with the herbs and match the cream's texture. Condrieu's intense floral (honeysuckle, apricot) and spicy notes are the perfect textural and aromatic match. Oaked Marsanne/Roussanne offers a similar profile." },
                        "Reduction / Stock-Finished Cream Sauce": { "result_specific": "Corton-Charlemagne, Burgundy (Grand Cru Chardonnay)", "result_general": "Aged White Bordeaux (Semillon/Sauvignon Blanc)", "rationale": "The added depth of a rich stock reduction requires a wine with unparalleled structure, concentration, and long aging potential. Corton-Charlemagne provides the necessary power and intense minerality to cut through the richness while matching the complexity of the stock. Aged White Bordeaux also develops savory, nutty complexity ideal for rich sauces." }
                    }
                },
                // LEVEL 2: Wild Game (Venison, Boar, Duck)
                "Wild Game (Venison, Boar, Duck)": {
                    "next_prompt": "4. Choose Game Detail:",
                    "options": {
                        "Mature Game (Strong/Iron Flavor) / Venison, Boar": { "result_specific": "Cornas, Northern Rh√¥ne (Syrah)", "result_general": "Aged Barolo or Barbaresco (Piedmont, Nebbiolo)", "rationale": "Strong, mature, iron-rich game requires a wine of massive structure, savory complexity, and intense dark fruit/pepper notes. Cornas provides the necessary power and 'meaty' character to stand up to the gaminess. Aged Nebbiolo offers a structured alternative with dried-fruit and rose-petal notes that complement the iron-rich flavor." },
                        "Lean / Younger Game (Pheasant, Partridge)": { "result_specific": "Volnay or Savigny-l√®s-Beaune, Burgundy (Pinot Noir)", "result_general": "Cool-Climate Pinot Noir (Germany/Austria)", "rationale": "Lean, delicate game needs a subtle red wine that won't overwhelm its natural flavor. Pinot Noir from the softer villages of the C√¥te de Beaune provides the perfect balance of earthiness, high acidity, and refined fruit structure. Cool-climate European Pinot Noir offers similar elegance and structure." },
                        "Duck / Goose (High Fat Content)": { "result_specific": "Gevrey-Chambertin, Burgundy (Pinot Noir)", "result_general": "California or New Zealand Pinot Noir", "rationale": "Duck and goose fat is famously rich. The ideal wine must have high acidity (the hallmark of quality Pinot Noir) to cut through the fat, and enough aromatic complexity to match the poultry's flavor. Gevrey-Chambertin offers both structure and earthy refinement. New World Pinot provides reliable high acidity and bright fruit." },
                        "Spiced / Curry / Exotically Seasoned Game": { "result_specific": "Gew√ºrztraminer (Vendanges Tardives) Alsace", "result_general": "Off-Dry Riesling (Alsace/Germany) or Oaked Viognier", "rationale": "Spice and exotic seasoning (e.g., cumin, coriander) are best matched by aromatic wines with a touch of residual sweetness to calm the heat. Alsace Gew√ºrztraminer is full-bodied, intensely aromatic (lychee, ginger), and often has enough off-dry character to pair with the spice. Off-Dry Riesling is the universal choice for spice." },
                        "Served Cold (Terrine / P√¢t√© style)": { "result_specific": "Blanc de Noirs Champagne (Pinot Noir/Meunier)", "result_general": "Dry Ros√© (Tavel or Bandol)", "rationale": "Cold, rich, pressed meats require a wine with cleansing acidity, effervescence, and enough body to match the richness. A Blanc de Noirs Champagne provides the richness and the necessary aggressive acidity and bubbles to cleanse the palate. A dry, structured Ros√© offers the body and refreshing acidity without the bubbles." }
                    }
                },
                // LEVEL 2: Offal / Highly Seasoned (Spicy, Herbaceous)
                "Offal / Highly Seasoned (Spicy, Herbaceous)": {
                    "next_prompt": "4. Choose Offal/Seasoning Detail:",
                    "options": {
                        "Foie Gras (Pan-Seared or Torchon)": { "result_specific": "Sauternes, Bordeaux (Botrytized Semillon/Sauvignon Blanc)", "result_general": "Late Harvest or Botrytized Wine (e.g., Tokaji, Vouvray Moelleux)", "rationale": "The quintessential pairing. The extreme sweetness and high acidity of Sauternes cut through the immense richness of the foie gras while matching its luxurious texture. The botrytis notes (honey, apricot) are a perfect aromatic complement. Any high-acid, sweet dessert wine works as a suitable substitute." },
                        "Liver (Calf, Chicken) / Rich Texture": { "result_specific": "St-Nicolas-de-Bourgueil, Loire Valley (Cabernet Franc)", "result_general": "Cru Beaujolais (e.g., Morgon) or Medium-Bodied Cabernet Franc", "rationale": "Liver is rich but often has a slightly metallic/iron note. Loire Cabernet Franc provides the high acidity necessary to slice through the richness and cleanse the palate, along with a classic, savory, medium body that stands up to the flavor. A structured, juicy Cru Beaujolais offers a similar high-acid, savory profile." },
                        "Kidney / Heart / Muscular Offal": { "result_specific": "Ch√¢teauneuf-du-Pape, Southern Rh√¥ne", "result_general": "Ribera del Duero (Tempranillo) or Powerful GSM Blend", "rationale": "Muscular offal is dense, firm, and requires a structured wine with immense flavor. Ch√¢teauneuf-du-Pape provides the necessary weight, complexity, and savory spice to match the texture and intensity of the meat. A robust, high-tannin Spanish Tempranillo is an excellent, readily available alternative." },
                        "Spicy / Paprika / Chili Seasoning": { "result_specific": "Sylvaner, Alsace (with a hint of residual sugar)", "result_general": "Off-Dry Riesling (any region) or Vinho Verde (Portugal)", "rationale": "High heat and spice are tamed by low alcohol, low tannin, and a touch of sweetness. Alsatian Sylvaner, often produced with a slightly off-dry character, is clean, refreshing, and calms the heat. Off-Dry Riesling is the universal best choice for spice due to its sugar and acid content." },
                        "Herbaceous / Lightly Fried (e.g., Tripe, Andouillette)": { "result_specific": "Muscadet S√®vre et Maine sur Lie, Loire Valley", "result_general": "Albari√±o (Spain) or Dry Italian Vernaccia di San Gimignano", "rationale": "For dishes like Andouillette (a pungent sausage) or simply prepared tripe, a crisp, mineral-driven white wine is needed. Muscadet's saline, mineral notes and piercing acidity are unmatched for cutting through fat and matching challenging, herbaceous flavors. Albari√±o offers similar coastal salinity and high acidity." }
                    }
                }
            }
        },
        // LEVEL 1: Poultry & White Meat
        "Poultry & White Meat": {
            "user_label": "üêî Poultry & White Meat",
            "next_prompt": "3. Choose Preparation/Sauce Base:",
            "options": {
                // LEVEL 2: Cream / Butter-Based: Blanquette de Veau, Poulet √† la Cr√®me
                "Cream / Butter-Based: Blanquette de Veau, Poulet √† la Cr√®me": {
                    "next_prompt": "4. Choose Cream/Butter Detail:",
                    "options": {
                        "Heavy Cream / Egg Yolk Base (Maximum Richness)": { "result_specific": "Corton-Charlemagne, Burgundy (Grand Cru Chardonnay)", "result_general": "Premium Oaked Chardonnay (e.g., California, Margaret River)", "rationale": "Maximum richness demands a wine of equivalent weight, concentration, and texture. Corton-Charlemagne offers unparalleled intensity, power, and high acidity to perfectly slice through the heavy fat while matching the texture." },
                        "Brown Butter / Nutty / Caramelized Flavor": { "result_specific": "Savenni√®res, Loire Valley (Chenin Blanc)", "result_general": "Aged White Rioja (Viura/Malvasia)", "rationale": "The nutty, savory, caramelized notes require a wine that has similar tertiary/developed flavors and structure. Savenni√®res (often aged) develops savory, beeswax, and almond notes with piercing acidity that complements the brown butter beautifully. Aged White Rioja offers a similar oxidative/nutty profile." },
                        "Light Cream / Cr√®me Fra√Æche Finish (High Acidity)": { "result_specific": "Sancerre, Loire Valley (Sauvignon Blanc)", "result_general": "Dry German Riesling (Trocken) or Alto Adige Pinot Grigio", "rationale": "The dish's light texture and high acid (from the cr√®me fra√Æche) demand a wine with high, crisp, clean acidity and minerality. Sancerre provides purity, lemon-zest acidity, and mineral structure that harmonizes with the light, refreshing cream base. Dry Riesling and crisp Pinot Grigio are excellent alternatives focused on high acidity." },
                        "Mushroom / Truffle Infusion in Cream": { "result_specific": "Puligny-Montrachet, Burgundy (Premier Cru Chardonnay)", "result_general": "Aged, Earthy Pinot Noir (e.g., Burgundy, Oregon)", "rationale": "The umami from the mushrooms/truffle needs a savory, complex wine. Puligny-Montrachet is full-bodied and develops subtle, earthy, savory notes with age, perfectly complementing the fungal flavors while cutting the cream. A lighter, earthy Pinot Noir is the classic red alternative for matching the earthiness." },
                        "Velout√© / Roux-Thickened Sauce (Smooth Texture)": { "result_specific": "Hermitage Blanc, Northern Rh√¥ne (Roussanne/Marsanne)", "result_general": "Oaked Viognier (Condrieu, etc.)", "rationale": "The velvety, smooth texture of a roux-thickened sauce requires a wine with a similarly round, full, and oily mouthfeel. Hermitage Blanc delivers intense textural weight and subtle aromatics that align seamlessly with the velout√©. Oaked Viognier is a highly textural, aromatic alternative." }
                    }
                },
                // LEVEL 2: Simple Roast / Grill: Roasted Chicken, Pork Loin
                "Simple Roast / Grill: Roasted Chicken, Pork Loin": {
                    "next_prompt": "4. Choose Preparation Detail:",
                    "options": {
                        "High Fat / Skin-On Roast (Chicken, Duck Breast)": { "result_specific": "Blanc de Noirs Champagne (Pinot Noir/Meunier)", "result_general": "High-Acid, Oaked Chardonnay (e.g., Chablis 1er Cru)", "rationale": "The high fat content demands a wine with piercing acidity to cleanse the palate. Champagne's high acid, effervescence, and yeasty richness (especially Blanc de Noirs) perfectly cut the fat while matching the texture of the crisp skin. A high-acid, structured, but oaked Chardonnay is the best still-wine alternative." },
                        "Lean / White Meat (Pork Loin, Veal)": { "result_specific": "Saint-V√©ran, M√¢connais (Unoaked Chardonnay)", "result_general": "Dry Ros√© (Provence) or Pinot Grigio", "rationale": "Lean, white meat requires a delicate wine that offers texture and crispness without aggressive tannins or overwhelming oak. Saint-V√©ran provides a rounder, mineral-driven alternative to Chablis, offering medium body and high freshness. A dry, crisp Ros√© or simple Pinot Grigio offers the necessary acidity and light body." },
                        "Rustic Herbs / Garlic / Simple Salt & Pepper": { "result_specific": "Bandol Ros√©, Provence (Mourv√®dre Blend)", "result_general": "Vermentino (e.g., Italian) or Dry Fino Sherry", "rationale": "Rustic, savory herbs (like herbes de Provence) require a dry, structured wine with an herbaceous or savory edge. Bandol Ros√© is uniquely full-bodied, structured, and earthy for a ros√©, pairing perfectly with the roast aromatics. Vermentino often exhibits complementary herbal notes and good structure." },
                        "Smoky / Charred Grill Finish": { "result_specific": "Crozes-Hermitage, Northern Rh√¥ne (Syrah)", "result_general": "Medium-Bodied Syrah or C√¥tes du Rh√¥ne", "rationale": "The smoky and charred notes demand a wine with a similarly savory, slightly peppery, and meaty profile. Northern Rh√¥ne Syrah is known for this profile and has the structure to match the grill intensity without being excessively tannic for white meat. A medium-bodied, savory Syrah blend is a readily available substitute." },
                        "Sweet Glaze / Honey / Maple Finish": { "result_specific": "Vouvray Sec or Demi-Sec, Loire Valley (Chenin Blanc)", "result_general": "Off-Dry Riesling (e.g., German Sp√§tlese)", "rationale": "Sweet glazes clash with dry wines, so the wine must contain a trace of residual sugar or intense, concentrated fruit to balance the sweetness. Vouvray Demi-Sec (or even Sec with high fruit concentration) provides the necessary sugar/fruit balance along with crisp acidity. Off-Dry Riesling is the universal best choice for sweetness in savory dishes." }
                    }
                },
                // LEVEL 2: Wine / Stock Reduction (Light): Fricass√©e, light Jus
                "Wine / Stock Reduction (Light): Fricass√©e, light Jus": {
                    "next_prompt": "4. Choose Reduction Detail:",
                    "options": {
                        "White Wine Reduction / Light Stock (Veal, Chicken)": { "result_specific": "Pouilly-Fuiss√©, M√¢connais (Chardonnay)", "result_general": "Unoaked/Lightly Oaked White Burgundy or Pinot Blanc (Alsace)", "rationale": "A light reduction needs a white wine with moderate richness, subtle oak (optional), and bright acidity to match the stock's body without overpowering the light meat. Pouilly-Fuiss√© offers the perfect balance of richness and clean minerality. Unoaked/lightly oaked Chardonnay provides the required body and texture." },
                        "Red Wine Reduction / Dark Stock (Duck, Pork)": { "result_specific": "Aged Beaujolais Cru (e.g., Morgon or Moulin-√†-Vent)", "result_general": "Chilled, Light-Bodied Pinot Noir (e.g., Sancerre Rouge)", "rationale": "The dark stock and reduction need a red wine, but one that is light enough for the poultry/white meat. A structured, aged Cru Beaujolais provides earthy complexity and soft tannins to harmonize with the reduction without clashing with the meat. A light, high-acid Pinot Noir works due to its delicate structure." },
                        "Vegetable Broth / Mushroom Infusion": { "result_specific": "Auxey-Duresses Blanc, Burgundy (Chardonnay)", "result_general": "Dry White Blend (e.g., Roussanne/Marsanne) or Aged Chenin Blanc", "rationale": "The earthy, savory umami notes require a wine with similar savory complexity and weight. White Burgundy from a lesser-known appellation offers the richness and subtle earthy notes needed to complement the mushrooms/broth. Dry, savory white blends or aged Chenin Blancs are excellent alternatives for their depth." },
                        "Vin Jaune / Nutty / Oxidative Stock": { "result_specific": "Ch√¢teau-Chalon, Jura (Vin Jaune - Savagnin)", "result_general": "Dry Amontillado Sherry (Spain)", "rationale": "This is a specific pairing that demands a wine with the same pronounced, oxidative, nutty flavor as the cooking ingredient. Vin Jaune is the only wine that truly matches this profile. Dry Amontillado Sherry is the most available and texturally similar alternative for its aged, oxidative character." },
                        "Tomato / Bell Pepper / Proven√ßal Infusion": { "result_specific": "Bandol Ros√©, Provence (Mourv√®dre Blend)", "result_general": "Vermentino di Sardegna or Light-Bodied Sangiovese Ros√©", "rationale": "The high acidity of the tomato and the herbal, peppery notes of Proven√ßal vegetables require a wine with structure, high acidity, and a savory profile. Structured, age-worthy Bandol Ros√© fits this perfectly. Vermentino or a Sangiovese Ros√© provides the necessary acid and herbal/salty characteristics." }
                    }
                },
                // LEVEL 2: Spicy / Curry (Modern): Slightly spiced preparations
                "Spicy / Curry (Modern): Slightly spiced preparations": {
                    "next_prompt": "4. Choose Spice Detail:",
                    "options": {
                        "Red Spice / Chili / High Heat": { "result_specific": "Off-Dry Riesling (Mosel, Germany)", "result_general": "Vinho Verde (Portugal) or Dry Sparkling Ros√©", "rationale": "High heat is magnified by high alcohol and high tannin. The best pairings feature low alcohol, low tannin, and residual sugar to soothe the heat. Mosel Riesling is renowned for its low alcohol, high acidity, and slight sweetness. Vinho Verde offers a low-alcohol, slight effervescence contrast that is also effective." },
                        "Yellow Spice / Aromatic Curry (e.g., Turmeric, Saffron)": { "result_specific": "Gew√ºrztraminer (Alsace)", "result_general": "Viognier (California or Southern France)", "rationale": "Aromatic, savory spices require an equally intense and aromatic wine to match the complexity. Gew√ºrztraminer's intense floral (lychee, rose), ginger, and often off-dry character is the classic match for saffron and turmeric. Viognier offers a similar full-bodied, aromatic profile." },
                        "Ginger / Citrus / Fresh Spice": { "result_specific": "Vouvray Sec or Demi-Sec, Loire Valley (Chenin Blanc)", "result_general": "New Zealand Sauvignon Blanc or Dry Furmint (Hungary)", "rationale": "Fresh, high-acid spices (ginger, citrus zest) need a wine with high, crisp acidity and complementary fruit notes. Vouvray (Sec or Demi-Sec) provides a honeyed texture and bright acidity that works seamlessly with ginger and citrus. New Zealand Sauvignon Blanc offers reliable high acid and pungent citrus notes." },
                        "Pungent Spice / Clove / Cardamom Focus": { "result_specific": "Tokaji Furmint (Dry or Off-Dry, Hungary)", "result_general": "Dry Oaked Chenin Blanc (e.g., South Africa)", "rationale": "Pungent, assertive spices require a wine with structure, body, and a subtle savory or oxidative component to balance their intensity. Dry Furmint offers intense minerality, structure, and a slightly waxy texture. Oaked Chenin Blanc has the requisite body and flavor complexity." },
                        "Coconut Milk / Creamy Spice Base": { "result_specific": "Roussanne / Marsanne Blend (Northern Rh√¥ne)", "result_general": "Full-Bodied, Unoaked Chardonnay or Pinot Gris (Alsace)", "rationale": "The fat from the coconut milk needs a wine with substantial body and high acidity to cut the richness. Roussanne/Marsanne blends are full-bodied, slightly oily in texture, and possess enough structure to match the coconut fat. Unoaked but full-bodied Chardonnay provides a reliable high-acid, textural alternative." }
                    }
                },
                // LEVEL 2: Simple Pan-Saut√© / Lemon: Veal Escalope
                "Simple Pan-Saut√© / Lemon: Veal Escalope": {
                    "next_prompt": "4. Choose Finish Detail:",
                    "options": {
                        "High Lemon / Aggressive Citrus Finish": { "result_specific": "Muscadet S√®vre et Maine sur Lie, Loire Valley", "result_general": "Bone-Dry Riesling (Alsace/Austria) or Vinho Verde", "rationale": "The high, aggressive acidity of the lemon demands a wine with equally piercing, cleansing acidity. Muscadet's signature high acid and mineral/saline character harmonizes with the lemon, acting as a palate cleanser. Bone-Dry Riesling provides the necessary high acidity without competing flavors." },
                        "Brown Butter Sauce / Rich Fat Finish (Meuni√®re Style)": { "result_specific": "Saint-Aubin, Burgundy (Oaked Chardonnay)", "result_general": "Oaked Chardonnay (Cool Climate) or White Burgundy (C√¥te Chalonnaise)", "rationale": "Brown butter needs a wine with textural weight, complexity, and good acid to cut the fat and complement the nutty flavor. Saint-Aubin offers the richness of Burgundy with good minerality. A cool-climate, subtly oaked Chardonnay provides the required body and richness." },
                        "Simple Salt / Flour Dusting (No Sauce)": { "result_specific": "Chablis, Burgundy (Unoaked Chardonnay)", "result_general": "Pinot Blanc (Alsace) or Dry, Crisp Pinot Grigio", "rationale": "A simple, unadorned preparation requires a wine that focuses purely on freshness, minerality, and clean structure. Chablis' steely, high-acid, and mineral-driven profile enhances the natural flavor of the meat without competition. Pinot Blanc is a reliable, structured, and neutral alternative." },
                        "Caper / Anchovy / Saline Garnish": { "result_specific": "Vermentino di Sardegna, Sardinia", "result_general": "Albari√±o (Spain) or Assyrtiko (Greece)", "rationale": "Salty, pungent garnishes (capers, anchovy) need a wine with a distinct saline/coastal minerality and high acidity to cut the salt and richness. Vermentino, especially from Sardegna, provides the ideal salty, herbaceous match. Albari√±o and Assyrtiko are excellent high-acid, saline alternatives." },
                        "Parsley / Fresh Herb Finish": { "result_specific": "Sancerre, Loire Valley (Sauvignon Blanc)", "result_general": "New Zealand Sauvignon Blanc or Gruner Veltliner (Austria)", "rationale": "The green herbaceous flavor of the parsley requires a wine with a complementary, often green/herbal aromatic profile. Sancerre's classic grassy, citrus, and mineral notes are the perfect match for fresh herbs. New World Sauvignon Blanc and Gruner Veltliner offer reliable herbal notes and high acidity." }
                    }
                }
            }
        },
        // LEVEL 1: Seafood & Shellfish
        "Seafood & Shellfish": {
            "user_label": "üêü Seafood & Shellfish",
            "next_prompt": "3. Choose Preparation/Sauce Base:",
            "options": {
                // LEVEL 2: Raw / Steamed (Oysters, Clams)
                "Raw / Steamed (Oysters, Clams)": {
                    "next_prompt": "4. Choose Preparation Detail:",
                    "options": {
                        "Oysters / Raw Shellfish (High Salinity)": { "result_specific": "Muscadet S√®vre et Maine sur Lie (Loire Valley)", "result_general": "Chablis (Unoaked Chardonnay) or Spanish Albari√±o", "rationale": "The supreme match for salinity. Muscadet's piercing acidity, dry profile, and notes of iodine/minerality enhance the oyster's brine. Chablis and Albari√±o offer similar high acid and mineral purity." },
                        "White Fish Ceviche / Citrus Cure (High Acidity)": { "result_specific": "Sancerre (Loire Valley Sauvignon Blanc)", "result_general": "Bone-Dry Riesling (Austria/Alsace) or Dry Gr√ºner Veltliner", "rationale": "The high citrus acidity demands a wine with matching, very high acidity to prevent the wine from tasting flabby. Sancerre's clean, acidic, and slightly herbaceous profile is ideal. Bone-Dry Riesling provides the necessary acid structure." },
                        "Steamed White Fish / No Sauce (Delicate)": { "result_specific": "Picpoul de Pinet (Languedoc-Roussillon)", "result_general": "Pinot Grigio (Italy) or Simple Vinho Verde", "rationale": "A delicate dish requires a light, neutral wine that highlights the fish's natural flavor. Picpoul's lean body, high acidity, and slight salinity are perfect for neutrality and cleansing. Simple, dry white wines work well here." },
                        "Steamed Mussels / White Wine Broth": { "result_specific": "Bourgogne Aligot√© (Burgundy)", "result_general": "Dry Ros√© (Provence) or Dry Sauvignon Blanc (Any)", "rationale": "The broth needs a wine with good acidity and a simple, refreshing character. Aligot√© is a high-acid, clean white that complements the simple broth without distracting from the shellfish. Dry Ros√© works for its freshness and slight structure." },
                        "Crudo / Olive Oil Drizzle (Oily Texture)": { "result_specific": "Vermentino di Sardegna (Sardinia)", "result_general": "Assyrtiko (Greece) or Dry Ros√© from Bandol", "rationale": "The light oil needs a wine with high acidity and a savory, almost saline minerality to cut through. Vermentino offers the necessary texture and coastal minerality. Assyrtiko has the intense structure and acidity required." }
                    }
                },
                // LEVEL 2: Rich Butter / Cream Sauce (e.g., Meuni√®re, Nantaise)
                "Rich Butter / Cream Sauce (e.g., Meuni√®re, Nantaise)": {
                    "next_prompt": "4. Choose Sauce Detail:",
                    "options": {
                        "Heavy Cream / Egg Yolk Base (Lobster/Scallop)": { "result_specific": "Meursault, Burgundy (Oaked Chardonnay)", "result_general": "Premium Oaked Chardonnay (e.g., Napa, South Africa)", "rationale": "The luxurious texture and richness of the sauce demand a wine of equivalent body and creamy texture. Meursault's roundness and buttery notes are the classic match, with enough acid to cleanse the fat. A high-quality oaked Chardonnay provides the textural match." },
                        "Brown Butter / Nutty / Caramelized Flavor (Meuni√®re)": { "result_specific": "Savenni√®res, Loire Valley (Aged Chenin Blanc)", "result_general": "Aged White Bordeaux (Semillon/Sauvignon Blend)", "rationale": "The nutty, savory flavor of Beurre Noisette (brown butter) needs a white wine with developed, tertiary notes. Savenni√®res (often aged) develops complex almond, savory, and waxy notes. Aged White Bordeaux also provides the necessary nutty complexity and structure." },
                        "Herb-Focused Cream Sauce (Dill, Chives)": { "result_specific": "Condrieu, Northern Rh√¥ne (Viognier)", "result_general": "Oaked Roussanne or Full-Bodied, Herbal Sauvignon Blanc", "rationale": "Strong herbs need a wine with intense aromatics and body. Condrieu's oily texture, floral, and peach notes harmonize beautifully with cream and herbs like chives. Oaked Roussanne offers a similar textural weight." },
                        "Light Cream / Lemon Finish (Sole/Cod)": { "result_specific": "Chassagne-Montrachet, Burgundy (Chardonnay)", "result_general": "High-Quality White Burgundy (C√¥te Chalonnaise)", "rationale": "This lighter style needs a wine that blends richness with pronounced minerality and acidity. Chassagne-Montrachet provides the perfect balance of creamy texture and high, cleansing acid. Other villages in Burgundy offer a more accessible, quality balance." },
                        "Roux-Thickened Sauce (Velout√© Texture)": { "result_specific": "Hermitage Blanc, Northern Rh√¥ne (Roussanne/Marsanne)", "result_general": "Oaked Marsanne/Viognier Blend", "rationale": "The smooth, velvety texture of the roux requires a wine with a similarly round, full, and sometimes slightly oily mouthfeel. Hermitage Blanc delivers intense textural weight and subtle aromatics that pair seamlessly with the sauce." }
                    }
                },
                // LEVEL 2: Tomato / Saffron / Mediterranean Style
                "Tomato / Saffron / Mediterranean Style": {
                    "next_prompt": "4. Choose Style Detail:",
                    "options": {
                        "Rich Tomato Base / Stew (Bouillabaisse, Cioppino)": { "result_specific": "Bandol Ros√©, Provence (Mourv√®dre Blend)", "result_general": "Dry, Structured Ros√© (Tavel) or Light-Bodied Sangiovese", "rationale": "The high acidity and intensity of a rich tomato base need a wine with substantial body and high acidity. Bandol Ros√© is uniquely structured, earthy, and deep, capable of standing up to the stew. Structured Ros√© or a very light, high-acid red (Sangiovese) works well." },
                        "Saffron / Pepper Spice Focus": { "result_specific": "Gew√ºrztraminer (Alsace)", "result_general": "Viognier or Dry Chenin Blanc (Vouvray Sec)", "rationale": "Saffron's intense, savory-aromatic flavor demands a highly aromatic, slightly spicy white wine. Gew√ºrztraminer's full body, floral/spicy notes, and low acidity complement the saffron. Viognier offers a similar textural and aromatic match." },
                        "Light Tomato Vinaigrette / Cold Service": { "result_specific": "Dry Ros√© (Provence or Languedoc)", "result_general": "Dry Riesling or High-Acid Vinho Verde", "rationale": "High-acid, cold dishes need a crisp, refreshing, and clean wine. Dry Proven√ßal Ros√© provides the perfect high acidity, fruit, and light body without clashing with the subtle tomato. High-acid white wines are the best substitute." },
                        "Fennel / Anise / Pungent Herb Focus": { "result_specific": "Assyrtiko (Santorini, Greece)", "result_general": "Vermentino or Sauvignon Blanc (Steely/Herbal)", "rationale": "Pungent, herbal flavors need a wine with piercing acidity and a strong mineral or savory component. Assyrtiko has intense acidity and a saline quality that cuts through the herbs." },
                        "Garlic / Basil / Simple Marinara": { "result_specific": "Vermentino di Gallura (Sardinia)", "result_general": "Sauvignon Blanc/Semillon Blend (Bordeaux)", "rationale": "Simple classic herbs and tomato need a high-acid wine with neutral or complementary green notes. Vermentino has the required acid and structure. White Bordeaux offers a slightly herbal, structured alternative that handles the tomato acidity." }
                    }
                },
                // LEVEL 2: Oily / Rich Fish (Salmon, Tuna, Swordfish)
                "Oily / Rich Fish (Salmon, Tuna, Swordfish)": {
                    "next_prompt": "4. Choose Preparation Detail:",
                    "options": {
                        "Pan-Seared / Grilled (High Fat Content)": { "result_specific": "Sancerre Rouge (Loire Valley Pinot Noir)", "result_general": "Cru Beaujolais (Fleurie, Morgon) or Dry Ros√© from Bandol", "rationale": "The fat content of the fish requires a wine with high acid and enough structure to cleanse the palate. Sancerre Rouge is a light, high-acid Pinot Noir that provides the necessary acidity and light red fruit. Cru Beaujolais is a good, low-tannin red alternative." },
                        "Smoked Fish (Salmon, Trout)": { "result_specific": "Off-Dry Riesling (Alsace or Germany)", "result_general": "Vouvray Demi-Sec (Chenin Blanc)", "rationale": "The smoke and oil need a wine with a slight residual sweetness to balance the salinity and pungent smoke, combined with high acid. Off-Dry Riesling is the classic match. Vouvray Demi-Sec offers a similar sweet-acid contrast." },
                        "Tuna or Swordfish Steak (Meaty Texture)": { "result_specific": "Bandol Rouge (Mourv√®dre-Dominant)", "result_general": "Light, Earthy Pinot Noir (Burgundy) or Tempranillo Ros√©", "rationale": "Meaty fish can handle a low-tannin red wine. Bandol Rouge, when young, has structure and savory notes that match the meaty texture without the high tannins of Cabernet. A lighter, savory Pinot Noir is the safest option." },
                        "Raw or Seared Tuna/Salmon (Simple Seasoning)": { "result_specific": "Chablis 1er Cru (Unoaked Chardonnay)", "result_general": "Dry Champagne (Blanc de Blancs)", "rationale": "Raw preparations require purity, high minerality, and texture. Premier Cru Chablis offers a balance of body and intense, clean minerality. Dry Champagne is a superb pairing due to its high acid and ability to cleanse the palate." },
                        "Dill / Horseradish / Pungent Garnish": { "result_specific": "Gr√ºner Veltliner Smaragd (Austria)", "result_general": "Savenni√®res (Chenin Blanc) or Dry Sauvignon Blanc", "rationale": "Pungent garnishes need a wine with high acidity and a complementary savory/peppery component. Gr√ºner Veltliner offers a unique white pepper and structure that pairs well with dill and horseradish. Savenni√®res works for its intensity and body." }
                    }
                },
                // LEVEL 2: Shellfish Stews / Bisques
                "Shellfish Stews / Bisques": {
                    "next_prompt": "4. Choose Style Detail:",
                    "options": {
                        "Cream-Based Bisque (Rich Texture)": { "result_specific": "Puligny-Montrachet, Burgundy (Chardonnay)", "result_general": "Full-Bodied, Oaked White Bordeaux", "rationale": "The rich, thick texture of a cream bisque demands a wine with equivalent textural body and high acidity to prevent the mouthfeel from becoming heavy. Puligny-Montrachet provides the elegance, structure, and intense body required." },
                        "Dry Sherry / Oxidative Broth": { "result_specific": "L'√âtoile, Jura (Savagnin or Vin Jaune)", "result_general": "Dry Amontillado Sherry (Spain)", "rationale": "An oxidative base requires a wine that matches the flavor profile. Jura wines (Savagnin, Vin Jaune) have the characteristic nutty, savory, and oxidative notes. Dry Amontillado is the closest textural and flavor match available outside of the Jura." },
                        "Tomato / Saffron Bouillon (High Acid)": { "result_specific": "Cassis, Provence (Marsanne/Clairette Blend)", "result_general": "Vermentino or Pinot Grigio (Alto Adige)", "rationale": "The aromatic spice and high acid require a full-bodied, yet crisp, white. Cassis provides the structure of Provence whites with intense aromatics. High-acid Italian whites are reliable substitutes." },
                        "Herbaceous / Light Broth (Cilantro, Ginger)": { "result_specific": "Roussette de Savoie (Altesse)", "result_general": "Dry Sauvignon Blanc or Gr√ºner Veltliner", "rationale": "A delicate, aromatic broth needs a wine that is intensely aromatic and clean. Roussette de Savoie (Altesse) provides a highly aromatic, floral, and savory profile that is perfect for light herbal notes." },
                        "Simple Shellfish Stock / No Dairy": { "result_specific": "Chablis 1er Cru (Unoaked Chardonnay)", "result_general": "Muscadet S√®vre et Maine or Assyrtiko", "rationale": "A simple, clean, saline stock requires a wine of purity, high minerality, and piercing acidity. Premier Cru Chablis provides depth and the essential mineral spine. Muscadet and Assyrtiko are excellent for their distinct salinity." }
                    }
                }
            }
        },
        // LEVEL 1: Vegetarian & Starters
        "Vegetarian & Starters": {
            "user_label": "ü•¶ Vegetarian & Starters",
            "next_prompt": "3. Choose Focus/Texture:",
            "options": {
                // LEVEL 2: Green & Leafy Vegetables / Herbacous
                "Green & Leafy Vegetables / Herbacous": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Asparagus / Artichoke (Challenging Green Notes)": { "result_specific": "Sauvignon Blanc (Sancerre, Loire Valley)", "result_general": "Dry Albari√±o (Spain) or Muscadet S√®vre et Maine", "rationale": "The intense herbaceousness/green notes (pyrazines) in Sauvignon Blanc are the one of the few wine components that truly complement the difficult flavors of asparagus and artichoke. Its high acidity cuts through any subtle bitterness. Albari√±o offers similar high acidity and structure." },
                        "Green Bean / Simple Steamed Vegetables": { "result_specific": "Pinot Blanc (Alsace)", "result_general": "Dry Riesling (Trocken) or Simple Vinho Verde", "rationale": "Simple, clean vegetables require a highly neutral and crisp white wine that highlights the freshness without adding aggressive flavor. Pinot Blanc is versatile, neutral, and has good balancing acidity and body. Dry Riesling is the go-to for clean, high-acid structure." },
                        "High Fresh Herb Content (Parsley, Basil, Chives)": { "result_specific": "Touraine, Loire Valley (Sauvignon Blanc/Fi√© Gris)", "result_general": "Vermentino (e.g., Italian) or Gruner Veltliner", "rationale": "Fresh, intense herbs demand a wine with a complementary, often citrus/herbal aromatic profile. A Sauvignon Blanc from Touraine often has cleaner, brighter herbal notes than Sancerre. Vermentino or Gr√ºner Veltliner both offer high acidity and subtle herbal/peppery components." },
                        "Raw Greens / Vinaigrette (High Acidity)": { "result_specific": "Muscadet S√®vre et Maine sur Lie (Loire Valley)", "result_general": "Dry Sparkling Wine (e.g., Cr√©mant de Loire) or Picpoul de Pinet", "rationale": "High-acid vinaigrettes must be matched by a wine with equally high, cleansing acidity and a mineral spine. Muscadet's piercing acid and saline edge are ideal for the dressing. Sparkling wine works well because the bubbles and acid cleanse the palate aggressively." },
                        "Cooked Spinach / Light Cream Sauce": { "result_specific": "Bourgogne Blanc (Chardonnay)", "result_general": "Pinot Gris (Alsace) or Dry Marsanne/Roussanne", "rationale": "Cooked spinach introduces a savory/earthy note and the cream adds body. The wine needs texture to match the cream and enough earthiness to harmonize with the spinach. White Burgundy provides subtle richness and acid. Pinot Gris offers full body and savory notes." }
                    }
                },
                // LEVEL 2: Root / Earthy Vegetables (Mushrooms, Truffles)
                "Root / Earthy Vegetables (Mushrooms, Truffles)": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Porcini / Truffle / Highly Earthy Mushrooms": { "result_specific": "Savigny-l√®s-Beaune, Burgundy (Mature Pinot Noir)", "result_general": "Piedmont Nebbiolo (e.g., Langhe Nebbiolo) or Aged White Burgundy", "rationale": "Intense earthiness and umami demand a savory wine with complex, tertiary (forest floor, mushroom) notes. Mature, medium-bodied Pinot Noir from Burgundy is the classic match, mirroring the flavors. Nebbiolo and aged Chardonnay are excellent alternatives offering similar depth and structure." },
                        "Roasted Root Vegetables (Carrot, Parsnip, Sweetness)": { "result_specific": "Vouvray Sec or Demi-Sec, Loire Valley (Chenin Blanc)", "result_general": "Off-Dry Riesling (e.g., German Sp√§tlese) or Dry Pinot Gris (Alsace)", "rationale": "Roasting caramelizes the vegetables, introducing sweetness that clashes with bone-dry, high-acid wines. Vouvray (Sec or Demi-Sec) provides balancing acidity and residual sugar or concentrated fruit to harmonize with the sweetness. Off-Dry Riesling is universally recommended for sweet savory dishes." },
                        "Simple Button Mushroom Saut√© / Garlic": { "result_specific": "Beaujolais-Villages (Gamay)", "result_general": "Valpolicella (Italian) or Lighter Pinot Noir", "rationale": "Simple, saut√©ed mushrooms require a light, slightly earthy red wine that offers brightness and soft tannins. Beaujolais-Villages provides juicy red fruit, minimal tannin, and a touch of earthiness that won't overwhelm the dish. Simple, high-acid reds are the best alternatives." },
                        "Celery Root / Salsify (Earthy/Bitter Notes)": { "result_specific": "Savenni√®res, Loire Valley (Chenin Blanc)", "result_general": "Dry White Blend (e.g., Marsanne/Roussanne) or Aged Hunter Valley Semillon", "rationale": "These vegetables have complex, sometimes slightly bitter or waxy notes. Savenni√®res' firm structure, high acidity, and savory, waxy/nutty notes complement the texture and flavor beautifully. Wines with tertiary complexity and firm structure work best." },
                        "Creamy Root Vegetable Puree / Mash": { "result_specific": "St-Aubin, Burgundy (Oaked Chardonnay)", "result_general": "Full-Bodied, Oaked White (e.g., Washington State Chardonnay)", "rationale": "The rich, thick texture of the puree (often with butter/cream) demands a full-bodied, rich white wine with enough acidity to cut through the fat. St-Aubin offers the body and creamy texture of high-end Chardonnay with balancing minerality. A premium Oaked Chardonnay is the reliable substitute." }
                    }
                },
                // LEVEL 2: Egg-Based (Omelets, Souffl√©s)
                "Egg-Based (Omelets, Souffl√©s)": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "High-Acid Vinaigrette / Mustardy Dressing": { "result_specific": "Muscadet S√®vre et Maine sur Lie (Loire Valley)", "result_general": "Bone-Dry Riesling (Alsace/Austria) or Picpoul de Pinet", "rationale": "The aggressive acidity and heat of mustard demands a wine with equally piercing, clean acidity and a mineral backbone. Muscadet's dry, saline, and high-acid profile is virtually unmatched for neutralizing vinegar. Bone-Dry Riesling is the next best high-acid alternative." },
                        "Mixed Salad with Protein (e.g., Tuna, Egg, Ham)": { "result_specific": "Bandol Ros√© (Provence, Mourv√®dre Blend)", "result_general": "Tavel Ros√© or Medium-Bodied Ros√© (e.g., Languedoc)", "rationale": "A mixed salad (like Salade Ni√ßoise) combines multiple challenging flavors (acid, oil, egg, protein). A structured, savory, full-bodied Ros√© is needed to harmonize these elements without clashing. Bandol is the classic choice for its depth and texture." },
                        "Terrine / Pressed Vegetable P√¢t√© (Gelatinous Texture)": { "result_specific": "Cr√©mant de Bourgogne (Blanc de Noirs)", "result_general": "Dry Sparkling Ros√© or Dry, Structured Chenin Blanc", "rationale": "The firm, chilled, and gelatinous texture requires a wine with high acidity, minerality, and effervescence to cleanse the palate and lift the weight. A Blanc de Noirs sparkling wine provides the necessary body and acid/bubbles. Dry, structured Chenin Blanc works well for its texture." },
                        "Grilled Vegetables / Olive Oil Base (Proven√ßal Flavors)": { "result_specific": "Cassis, Provence (Marsanne/Clairette Blend)", "result_general": "Vermentino or Dry Ros√© (Lighter Style)", "rationale": "Grilled vegetables (like Ratatouille served cold) have smoky and herbaceous notes with rich olive oil. Cassis offers a unique structured white with a Mediterranean herbal profile and good body. Vermentino is a reliable herbal, high-acid alternative." },
                        "Lentil / Bean Cold Salad (Starchy/Earthiness)": { "result_specific": "Bourgueil, Loire Valley (Cabernet Franc)", "result_general": "Light, Earthy Pinot Noir (e.g., Sancerre Rouge) or Structured Ros√©", "rationale": "Cold lentil or bean salads introduce starchy texture and earthiness. A light-bodied red with high acidity and soft tannins is ideal to handle the earthiness without clashing with the cold temperature. Cabernet Franc from the Loire is perfectly structured for this." }
                    }
                },
                // LEVEL 2: Legumes / Pulses (Lentils, Beans)
                "Legumes / Pulses (Lentils, Beans)": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Lentil Stew / Rich Stock Base (Savory Depth)": { "result_specific": "Beaujolais Cru (e.g., Morgon or Moulin-√†-Vent)", "result_general": "Loire Valley Cabernet Franc (Chinon) or Lighter Pinot Noir", "rationale": "Rich, earthy lentil stews need a light red wine that offers savory, earthy notes and bright acidity but low tannin. Cru Beaujolais provides the perfect depth, structure, and low-tannin profile to complement the stew's savory nature. Cabernet Franc is a good savory, high-acid red alternative." },
                        "White Bean Pur√©e / Olive Oil Finish (Texture)": { "result_specific": "Roussanne / Marsanne Blend (Northern Rh√¥ne)", "result_general": "Full-Bodied Unoaked Chardonnay or Dry Chenin Blanc (Savenni√®res)", "rationale": "The creamy texture of the pur√©e, enhanced by olive oil, requires a white wine with substance, textural body, and high acidity to cut the richness. Rh√¥ne white blends offer the necessary oiliness and structure. Full-bodied, high-acid whites are essential here." },
                        "Chickpea / Garbanzo Bean (Dense Texture)": { "result_specific": "Dry Ros√© (Tavel or Bandol)", "result_general": "Vermentino di Sardegna or Light-Bodied Sangiovese", "rationale": "Dense, starchy texture needs a wine with firm structure, high acidity, and aromatic complexity. Structured, savory dry Ros√©s (like Tavel) have the body and cut needed for the dense chickpeas. Vermentino offers a high-acid, savory white alternative." },
                        "Highly Seasoned (Cumin, Coriander) Beans": { "result_specific": "Gew√ºrztraminer (Alsace)", "result_general": "Viognier (with subtle residual sugar) or Off-Dry Riesling", "rationale": "Intense aromatic spices demand an equally aromatic, full-bodied white wine, often with a touch of residual sugar to balance the spice. Gew√ºrztraminer's intense floral and spicy character is the classic match. Viognier and Off-Dry Riesling offer similar intensity and spice-taming sweetness." },
                        "Cold Bean Salad / Vinaigrette (High Acidity)": { "result_specific": "Sancerre (Loire Valley Sauvignon Blanc)", "result_general": "Albari√±o (Spain) or Muscadet S√®vre et Maine", "rationale": "The high acidity of the vinaigrette requires a wine with piercing, clean acidity to harmonize with the dressing. Sancerre's high acid, crispness, and mineral/herbal notes are ideal for cold, high-acid salads. Muscadet is the best alternative for maximizing acid and minerality." }
                    }
                },
                // LEVEL 2: Nutty / Grain-Based Dishes (Buckwheat Cr√™pes)
                "Nutty / Grain-Based Dishes (Buckwheat Cr√™pes)": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Quiche / Savory Tart (High Fat Crust/Cheese)": { "result_specific": "Blanc de Blancs Champagne (Chardonnay)", "result_general": "Dry Cr√©mant d'Alsace or Dry, Structured Sauvignon Blanc", "rationale": "The high fat content (crust, cream, cheese) needs aggressive acidity and bubbles to cleanse the palate. Blanc de Blancs offers the purity, structure, and high acidity of Chardonnay with the cleansing power of effervescence. Dry Cr√©mant is the best value alternative." },
                        "Buckwheat / Dark Grains (Slight Bitterness/Earthiness)": { "result_specific": "Muscadet S√®vre et Maine sur Lie (Loire Valley)", "result_general": "Pinot Blanc (Alsace) or Dry Cider (Brittany)", "rationale": "Buckwheat introduces a specific earthy, slightly bitter note that requires a clean, structured, and mineral-driven wine to prevent bitterness. Muscadet's purity and saline structure are ideal. Pinot Blanc offers a clean, neutral body." },
                        "Rice / Creamy Grains (Risotto Style)": { "result_specific": "Bourgogne Blanc (Chardonnay)", "result_general": "Pinot Gris (Alsace) or Full-Bodied, Unoaked White", "rationale": "The high starch and potential creaminess demand a wine with sufficient body and cleansing acidity. White Burgundy provides the necessary textural match and structure. Pinot Gris is a reliable full-bodied white alternative." },
                        "Cheese-Filled Grains (Gruy√®re, Comt√©)": { "result_specific": "Ch√¢teau-Chalon, Jura (Vin Jaune)", "result_general": "Savagnin (Jura) or Aged Sherry (Amontillado)", "rationale": "These nutty, savory Alpine cheeses need a wine with complementary oxidative, tertiary, and nutty flavors. Vin Jaune is the perfect, regional, structured partner. Aged Sherry is the most available alternative that matches the complex flavor profile." },
                        "Nut-Crusted / Nutty Garnish (High Nut Flavor)": { "result_specific": "Savenni√®res, Loire Valley (Chenin Blanc)", "result_general": "Aged White Rioja or Oaked Roussanne", "rationale": "Pronounced nut flavors (almond, walnut) require a wine that has developed its own nutty, savory character. Savenni√®res often develops these notes with age, combined with high acid and structure. Aged White Rioja provides similar complexity." }
                    }
                }
            }
        },
        // LEVEL 1: Rich & slow cooked dishes
        "Rich & slow cooked dishes": {
            "user_label": "ü•ò Rich & Slow Cooked Dishes",
            "next_prompt": "3. Choose Preparation/Style:",
            "options": {
                // LEVEL 2: Wine-Based Stews (e.g., Bourguignon, Daube)
                "Wine-Based Stews (e.g., Bourguignon, Daube)": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Rich Beef/Veal Stew (Burgundian/Pinot Noir Base)": { "result_specific": "Nuits-Saint-Georges, Burgundy (Pinot Noir)", "result_general": "Oregon Pinot Noir or Aged Chianti Classico", "rationale": "The wine should match the Pinot Noir used in the Bourguignon. A structured village wine provides the necessary savory, earthy complexity, high acidity, and medium body to complement the slow-cooked beef and cut the sauce's richness. Aged Chianti offers similar savory, high-acid structure." },
                        "Lamb/Mutton Stew (Rh√¥ne/Syrah/Grenache Base)": { "result_specific": "Gigondas, Southern Rh√¥ne (GSM Blend)", "result_general": "Australian Shiraz or Spanish Garnacha", "rationale": "Stews using Southern French or Spanish wine bases need a wine with matching robustness, spice, and dark fruit. Gigondas provides the necessary rustic power, spice, and high alcohol content to handle the rich lamb and deeply flavored sauce. Bold GSM blends are ideal alternatives." },
                        "High Fat/Marrow Content": { "result_specific": "Pomerol, Bordeaux (Merlot-Dominant)", "result_general": "New World Merlot or Aged Right Bank Bordeaux", "rationale": "High fat requires a wine with plush texture and soft, refined tannins to integrate smoothly with the richness. Pomerol's Merlot-dominant blend offers this velvety texture and notes of plum and cedar. New World Merlot is a reliable alternative." },
                        "Game Stew (Boar, Venison) / Reduction": { "result_specific": "Cornas, Northern Rh√¥ne (Syrah)", "result_general": "Madiran (Tannat) or Aged Barolo", "rationale": "Intense game flavor needs a powerful, earthy, savory wine of immense structure. Cornas Syrah provides the necessary density, black pepper, and meaty savoriness to stand up to the gaminess and reduction. Madiran offers unmatched structure and tannin." },
                        "Wild Mushroom Infusion in Sauce": { "result_specific": "Pommard, Burgundy (Pinot Noir)", "result_general": "Piedmont Nebbiolo (e.g., Barbaresco)", "rationale": "Mushroom earthiness demands a wine with pronounced tertiary notes, high acidity, and structure. Pommard is known for its earthy, firmer structure among Burgundy villages. Nebbiolo is the classic alternative for intense earth/umami flavors." }
                    }
                },
                // LEVEL 2: Stock-Based Casseroles (e.g., Cassoulet, Pot-au-Feu)
                "Stock-Based Casseroles (e.g., Cassoulet, Pot-au-Feu)": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Rich Pork/Bean Casserole (Cassoulet Style)": { "result_specific": "Cahors (Malbec)", "result_general": "Madiran (Tannat) or Rustic Malbec (Argentina)", "rationale": "The dense, fatty, savory texture of Cassoulet needs a wine with firm, rustic tannins and deep, earthy flavor to cut the fat and match the meat/bean weight. Cahors (the original Malbec) provides this structure. Madiran is an equally powerful alternative." },
                        "Pot-au-Feu / Lean Beef Broth": { "result_specific": "Beaujolais Cru (e.g., Fleurie or Juli√©nas)", "result_general": "Loire Valley Cabernet Franc (Chinon)", "rationale": "A leaner, more savory broth needs a light red wine with bright acidity, soft tannins, and a savory/herbal edge for contrast. Beaujolais Crus offer the required freshness and earthy notes. Cabernet Franc is a high-acid, savory alternative." },
                        "Lamb/Mutton Casserole (Herbs/Root Vegetables)": { "result_specific": "Bandol Rouge (Mourv√®dre-Dominant)", "result_general": "Aged Spanish Monastrell (Mourv√®dre) or Aged Chianti", "rationale": "Lamb needs a wine with structure, high acidity, and savory/gamey notes. Bandol offers structure and earthy spice, matching the rich lamb. Aged Chianti provides similar savory complexity and high acid." },
                        "Fowl/White Meat Casserole (Chicken, Turkey)": { "result_specific": "Cairanne, Southern Rh√¥ne (GSM)", "result_general": "C√¥tes du Rh√¥ne or Medium-Bodied Zinfandel", "rationale": "White meat in a rich stock requires a medium-bodied, spicy red with soft tannins to match the intensity without overwhelming the meat. Cairanne offers the necessary body and savory spice. C√¥tes du Rh√¥ne is a good accessible blend." },
                        "Highly Spiced / Herbaceous Stock (e.g., Paprika)": { "result_specific": "Fitou, Languedoc (Carignan Blend)", "result_general": "Medium-Bodied Syrah or Zinfandel", "rationale": "Intense seasoning needs a bold, savory red with good body and alcohol to balance the spice. Fitou provides rustic intensity and spice. Syrah offers reliable peppery/spicy notes." }
                    }
                },
                // LEVEL 2: P√¢t√©s / Terrines / Rillettes
                "P√¢t√©s / Terrines / Rillettes": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Classic Pork P√¢t√© / Terrine (Herbaceous)": { "result_specific": "Sancerre Rouge (Loire Valley Pinot Noir)", "result_general": "Structured Dry Ros√© (Tavel) or Beaujolais Cru", "rationale": "The firm, cold, fatty texture needs a wine with high, cleansing acidity and a light, savory structure. Sancerre Rouge's high acidity and light red fruit cut the fat perfectly. A structured dry Ros√© is also a classic, high-acid match." },
                        "Rich Duck / Foie Gras Terrine": { "result_specific": "Dry Champagne (Blanc de Noirs)", "result_general": "Dry Sparkling Ros√© or Oaked White Burgundy", "rationale": "The high richness and fat content demand aggressive acidity and effervescence to cut the fat and lift the palate. Blanc de Noirs (Pinot Noir/Meunier) provides the necessary richness and structural body. Sparkling Ros√© is an excellent alternative." },
                        "Rillettes / Soft Spread (Maximum Fat)": { "result_specific": "Cr√©mant d'Alsace (Pinot Blanc/Auxerrois)", "result_general": "Champagne (Extra Brut) or High-Acid Vinho Verde", "rationale": "The extreme fat/creamy texture needs a wine with piercing, aggressive acidity and bubbles to cleanse the palate. Cr√©mant d'Alsace offers high quality and high acid/effervescence. Extra Brut Champagne is the ultimate high-acid cleanser." },
                        "Game P√¢t√© (Venison, Boar) / Spice": { "result_specific": "Ch√¢teauneuf-du-Pape (Mature)", "result_general": "Aged Syrah (Crozes-Hermitage) or Aged Tempranillo", "rationale": "Intense game flavors need a wine with complexity, age, and savory depth. A mature Ch√¢teauneuf-du-Pape provides tertiary notes and body to match the game. Aged, savory reds are key substitutes." },
                        "Country Terrine / Pickled Component": { "result_specific": "Vouvray Sec (Chenin Blanc)", "result_general": "Dry Riesling (Trocken) or German Sylvaner", "rationale": "The vinegary/acidic element from pickling requires a wine with high acidity and often a subtle fruit concentration to balance the tartness. Vouvray Sec provides the necessary acid and structure. Dry Riesling is the classic partner for acidic foods." }
                    }
                },
                // LEVEL 2: Rich Creamy Gratins / Vegetable Bakes
                "Rich Creamy Gratins / Vegetable Bakes": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Potato/Starch Gratin (Potatoes Au Gratin)": { "result_specific": "Puligny-Montrachet, Burgundy (Chardonnay)", "result_general": "Premium Oaked Chardonnay (Napa, Australia)", "rationale": "The dish is defined by high fat, starch, and creamy texture. It requires a wine with intense body, complexity, and high acidity. Puligny-Montrachet's structure and elegance are perfect. A full-bodied, oaked Chardonnay serves the textural purpose." },
                        "Rich Cheese Gratin (Comt√©, Gruy√®re)": { "result_specific": "Savenni√®res, Loire Valley (Chenin Blanc)", "result_general": "Aged White Rioja (Viura/Malvasia) or Dry Amontillado Sherry", "rationale": "Nutty, savory cheeses need a wine with high acidity and nutty/oxidative tertiary notes. Savenni√®res develops savory, beeswax, and almond notes with age. Aged White Rioja provides a similar complexity." },
                        "Baked Root Vegetable Gratin (Sweetness)": { "result_specific": "Vouvray Sec or Demi-Sec, Loire Valley (Chenin Blanc)", "result_general": "Off-Dry Riesling (Alsace) or Dry Pinot Gris (Alsace)", "rationale": "Roasting introduces sweetness that needs a wine with balancing acidity and a touch of residual sugar (or concentrated fruit). Vouvray Demi-Sec is ideal for this structure. Off-Dry Riesling is the most versatile choice for sweetness." },
                        "Pungent Vegetable Gratin (e.g., Fennel, Leek)": { "result_specific": "Condrieu, Northern Rh√¥ne (Viognier)", "result_general": "Oaked Roussanne or Dry Gew√ºrztraminer", "rationale": "Pungent vegetables require a wine with intense aromatics, body, and structure to match the unique flavor. Condrieu's oily texture, floral, and savory notes complement the dish. Aromatic, full-bodied whites are the best substitutes." },
                        "Stock-Based Gratin (No Cream, Savory)": { "result_specific": "Bourgogne Blanc (Chardonnay)", "result_general": "Pinot Gris (Alsace) or Dry Vermentino", "rationale": "A lighter, stock-based gratin requires a wine with good texture and clean minerality without excessive richness. Simple White Burgundy provides the necessary body and structure. Pinot Gris is a reliable full-bodied, dry option." }
                    }
                },
                // LEVEL 2: Oxidative / Nutty Flavor (e.g., Dishes with Vin Jaune, Foie Gras)
                "Oxidative / Nutty Flavor (e.g., Dishes with Vin Jaune, Foie Gras)": {
                    "next_prompt": "4. Choose Detail:",
                    "options": {
                        "Foie Gras (Pan-Seared or Torchon)": { "result_specific": "Sauternes, Bordeaux (Botrytized)", "result_general": "Late Harvest Chenin Blanc (Vouvray Moelleux) or Vintage Port", "rationale": "The essential pairing. The extreme sweetness and high acidity of Sauternes cut the immense richness of the foie gras while the honeyed notes complement the flavor. Any high-acid, unctuous sweet wine works as an alternative." },
                        "Cream Sauce with Vin Jaune / Comt√© Cheese": { "result_specific": "Ch√¢teau-Chalon, Jura (Vin Jaune)", "result_general": "Savagnin (Jura) or Dry Amontillado Sherry", "rationale": "The unique nutty, curry-like flavor of Vin Jaune demands a wine that is intentionally oxidative and shares the same flavor profile. Vin Jaune is the only true match. Dry Amontillado Sherry offers the closest flavor and textural structure." },
                        "Nut-Crusted / Nutty Garnish (High Nut Flavor)": { "result_specific": "Savenni√®res (Aged Chenin Blanc)", "result_general": "Aged White Rioja or Oaked Roussanne", "rationale": "Pronounced nut flavors require a wine that has developed its own nutty, tertiary character through aging. Savenni√®res gains these savory notes while retaining high acidity. Aged White Rioja offers similar complexity." },
                        "Oxidative Red Wine Sauce (Port or Madeira)": { "result_specific": "Banyuls (Vin Doux Naturel)", "result_general": "Ruby Port or Late Harvest Zinfandel", "rationale": "Dishes with highly reduced, oxidized, and slightly sweet fortified wine sauces need a wine that matches the sweetness and has similar oxidation notes. Banyuls is a fortified wine that offers this intensity and depth. Ruby Port is a good, accessible substitute." },
                        "Aged/Strong Cheese Base (Morbier, Old Comt√©)": { "result_specific": "Cr√©mant du Jura (Blanc de Noirs)", "result_general": "Dry Sparkling Ros√© or Dry Fino Sherry", "rationale": "Aged/pungent cheeses need a wine with high acidity, minerality, and structural firmness to cleanse the palate. Cr√©mant du Jura's bubbles and high acid are superb. Dry Fino Sherry is another excellent, high-acid, savory pairing." }
                    }
                }
            }
        }
    }
},
"Festive": {
    "title": "Festive Meals üéÑ",
    "emoji": "üéÑ",
    "next_prompt": "2. Choose Meal Style:",
    "options": {
        "Spread (Thanksgiving)": {
            "user_label": "ü¶É Holiday Spread (One Plate)",
            "next_prompt": "3. Choose Main Protein:",
            "options": {
                // --- ROAST TURKEY ---
                "Roast Turkey (Traditional)": {
                    "next_prompt": "4. Select Side Dish Profiles (Pick 1 or 2):",
                    "type": "multi_select",
                    "choices": {
                        "A": "Sweet & Tart (Cranberry)",
                        "B": "Rich & Creamy (Gravy/Mash)",
                        "C": "Earthy & Savory (Stuffing)",
                        "D": "Sweet & Spiced (Yams)"
                    },
                    "next_prompt_after_multi": "5. Choose Preparation Style:",
                    "options": {
                        // Single Side Options (Level 2)
                        "A": { "options": { "Heavy": {"result_specific": "Off-Dry Riesling OR Dry Ros√©", "result_general": "Chenin Blanc", "rationale": "High acidity and balanced residual sugar handle tartness and richness."}, "Light": {"result_specific": "Dry Riesling OR High Acidity Ros√©", "result_general": "Albari√±o", "rationale": "Wine must still combat high acidity and sugar, but without the need for a heavy body."} } },
                        "B": { "options": { "Heavy": {"result_specific": "Oaked Chardonnay OR Traditional Sparkling", "result_general": "White Rh√¥ne Blend", "rationale": "Acidity is the ultimate cleanser for rich, fatty sauces."}, "Light": {"result_specific": "Unoaked Chardonnay OR Cr√©mant", "result_general": "Pinot Grigio", "rationale": "High acidity cuts through lighter fat/cream without the weight of oak."} } },
                        "C": { "options": { "Heavy": {"result_specific": "Pinot Noir OR Cru Beaujolais", "result_general": "Sangiovese (Chianti Classico)", "rationale": "Low-tannin reds are ideal for savory/umami flavors like mushrooms and sage."}, "Light": {"result_specific": "Sancerre Rouge OR Gamay (Light Cru)", "result_general": "Valpolicella (Classico)", "rationale": "Look for lighter, more delicate expressions of low-tannin reds for subtle earthiness."} } },
                        "D": { "options": { "Heavy": {"result_specific": "Gew√ºrztraminer OR Zinfandel", "result_general": "Viognier", "rationale": "Aromatic wines are needed to meet the intensity of baking spices."}, "Light": {"result_specific": "Pinot Gris OR Vermentino", "result_general": "Gr√ºner Veltliner", "rationale": "An aromatic white is still key for the spices, but lighter in body."} } },
                        // Combination Side Options (Level 2 Combos)
                        "A+B": { "options": { "Heavy": {"result_specific": "Off-Dry Riesling OR Oaked Chardonnay", "result_general": "Dry Chenin Blanc", "rationale": "Classic challenge: requires both acidity (for tartness/richness) and body (for seasoning)."}, "Light": {"result_specific": "Dry Ros√© OR Slightly Off-Dry Chenin Blanc", "result_general": "Dry Ros√© Cava", "rationale": "Requires a highly versatile wine that is still light."} } },
                        "A+C": { "options": { "Heavy": {"result_specific": "Cru Beaujolais OR Pinot Noir", "result_general": "Gamay", "rationale": "Needs a red wine light in tannin, high in acidity, and bright fruit."}, "Light": {"result_specific": "Pinot Noir OR Beaujolais-Villages", "result_general": "Sancerre Rouge", "rationale": "A lighter red is needed to be versatile‚Äîhigh acid, low tannin."} } },
                        "A+D": { "options": { "Heavy": {"result_specific": "Gew√ºrztraminer OR Off-Dry Ros√©", "result_general": "Torront√©s", "rationale": "Mix of sweetness levels and high spices demands an Aromatic wine."}, "Light": {"result_specific": "Riesling Kabinett OR Dry Gew√ºrztraminer", "result_general": "Moscato d'Asti", "rationale": "Aromatic, slightly sweet wine is needed to harmonize these intense flavors."} } },
                        "B+C": { "options": { "Heavy": {"result_specific": "Pinot Noir OR Zinfandel", "result_general": "Grenache/GSM Blend", "rationale": "Medium body, low tannin, and juicy fruit to cut through richness while complementing savory stuffing."}, "Light": {"result_specific": "Unoaked Chardonnay (Chablis) OR Gamay", "result_general": "Bourgogne Aligot√©", "rationale": "Goal is to cleanse the cream while complementing the earthiness."} } },
                        "B+D": { "options": { "Heavy": {"result_specific": "Oaked Chardonnay OR Pinot Gris (Alsace)", "result_general": "Viognier", "rationale": "Requires a rich, textural wine that is full-bodied enough for the fat, with aromatic fruit to handle the spice."}, "Light": {"result_specific": "Pinot Gris OR Viognier", "result_general": "Pinot Blanc", "rationale": "Needs a white with body to handle the light fat, with aromatic fruit for the spice."} } },
                        "C+D": { "options": { "Heavy": {"result_specific": "Zinfandel OR Gamay", "result_general": "Primitivo", "rationale": "Must balance the earthy/savory with the bold spices; Zinfandel provides fruit and pepper notes."}, "Light": {"result_specific": "Beaujolais-Villages OR Lighter Zinfandel", "result_general": "Dolcetto", "rationale": "Red wine needs to be juicy and low in tannin to bridge savory and spiced elements."} } }
                    }
                },
                // --- FRIED TURKEY / GOOSE / DUCK ---
                "Fried Turkey / Goose / Duck": {
                    "next_prompt": "4. Select Side Dish Profiles (Pick 1 or 2):",
                    "type": "multi_select",
                    "choices": { "A": "Sweet & Tart", "B": "Rich & Creamy", "C": "Earthy & Savory", "D": "Sweet & Spiced" },
                    "next_prompt_after_multi": "5. Choose Preparation Style:",
                    "options": {
                        // Using a simple fallback for this example, the user can paste the remaining 38 specific pairings later.
                        "default": { "result_specific": "Extra Brut Champagne", "result_general": "High Acid Sparkling Wine", "rationale": "High acidity and bubbles are essential to cleanse the palate of the intense fat from frying." }
                    }
                },
                // --- HAM / ALTERNATIVE (BEEF) ---
                "Ham / Alternative (Beef/Roast)": {
                    "next_prompt": "4. Select Side Dish Profiles (Pick 1 or 2):",
                    "type": "multi_select",
                    "choices": { "A": "Sweet & Tart", "B": "Rich & Creamy", "C": "Earthy & Savory", "D": "Sweet & Spiced" },
                    "next_prompt_after_multi": "5. Choose Preparation Style:",
                    "options": {
                        "default": { "result_specific": "Zinfandel OR Off-Dry Riesling", "result_general": "Dry Ros√©", "rationale": "Needs bold fruit for beef, or sweetness/acid for ham glaze." }
                    }
                },
                // --- VEGETARIAN / SIDES ONLY ---
                "Vegetarian / Sides Only": {
                    "next_prompt": "4. Select Side Dish Profiles (Pick 1 or 2):",
                    "type": "multi_select",
                    "choices": { "A": "Sweet & Tart", "B": "Rich & Creamy", "C": "Earthy & Savory", "D": "Sweet & Spiced" },
                    "next_prompt_after_multi": "5. Choose Preparation Style:",
                    "options": {
                        "default": { "result_specific": "Pinot Noir OR Oaked Chardonnay", "result_general": "Sauvignon Blanc", "rationale": "Depends heavily on the primary vegetable flavor; high acidity is key." }
                    }
                }
            }
        },
        // --- MULTIPLE COURSES ---
        "Multiple Courses (Christmas)": {
            "user_label": "üçΩÔ∏è Multi-Course Meal",
            "next_prompt": "3. Choose Course:",
            "options": {
                // COURSE 1: AMUSE-BOUCHE
                "Amuse-Bouche / First Course": {
                    "next_prompt": "4. Choose Category:",
                    "options": {
                        "Shellfish / Raw Fish": {
                            "next_prompt": "5. Preparation:",
                            "options": {
                                "Served Raw/Briny": { "result_specific": "Dry Champagne (Brut Nature) OR Muscadet S√®vre et Maine", "result_general": "Dry Cava/Prosecco (Extra Brut)", "rationale": "High acidity and minerality enhance raw, salty nature." },
                                "Zesty/Citrus-Marinated": { "result_specific": "Sauvignon Blanc (Sancerre) OR Albari√±o", "result_general": "Pinot Grigio", "rationale": "High-acid, aromatic whites match zest/citrus." },
                                "Sweet/Fruity Sauce": { "result_specific": "Riesling Kabinett OR Gew√ºrztraminer", "result_general": "Off-Dry Ros√©", "rationale": "Slight sweetness balances the sauce." },
                                "Creamy/Rich": { "result_specific": "Blanc de Blancs Champagne OR Dry Fino Sherry", "result_general": "Dry Prosecco", "rationale": "Bubbles or sharp, dry Sherry cut the fat." }
                            }
                        },
                        "Cooked Seafood / Fish": {
                            "next_prompt": "5. Preparation:",
                            "options": {
                                "Simply Seared/Grilled": { "result_specific": "Dry Ros√© (Provence/Fuller) OR Vermentino", "result_general": "Sauvignon Blanc", "rationale": "Ros√© or aromatic whites match texture." },
                                "Creamy/Butter Sauce": { "result_specific": "Unoaked Chablis OR Dry Cr√©mant", "result_general": "Pinot Blanc", "rationale": "High-acid, unoaked whites cut the fat." },
                                "Spiced/Peppery": { "result_specific": "Gr√ºner Veltliner OR Dry Off-Dry Riesling", "result_general": "Off-Dry Ros√©", "rationale": "Gr√ºner's peppery notes complement spice." },
                                "Savory/Herbal": { "result_specific": "Pinot Noir (Very Light, Chilled) OR Sauvignon Blanc", "result_general": "Gamay (Beaujolais-Villages)", "rationale": "Light red or structured white with subtle earthiness." }
                            }
                        },
                        "Cured / Fatty Meat": {
                            "next_prompt": "5. Preparation:",
                            "options": {
                                "Sliced/Cured": { "result_specific": "Dry Lambrusco Secco OR Traditional Sparkling", "result_general": "Dry Cava", "rationale": "Effervescence and high acidity cut through salt and fat." },
                                "Creamy/P√¢t√©": { "result_specific": "Pinot Noir (Light-Bodied) OR Dry Chenin Blanc", "result_general": "Dry Ros√©", "rationale": "Low-tannin reds or structured whites handle richness." },
                                "Sweet/Glazed": { "result_specific": "Off-Dry Riesling (Sp√§tlese) OR Zinfandel", "result_general": "Dry Ros√© of Zinfandel", "rationale": "Fruit and residual sugar handle the sweetness/fat." },
                                "Savory/Smoked": { "result_specific": "Cru Beaujolais (Morgon) OR Dry Ros√© (Bandol/Tavel)", "result_general": "Pinot Noir (Basic, High Acid)", "rationale": "Earthy, savory reds or structured ros√©s handle gamey/smoked flavors." }
                            }
                        },
                        "Light Meat / Poultry": {
                            "next_prompt": "5. Preparation:",
                            "options": {
                                "Light/Herbal": { "result_specific": "Sauvignon Blanc (Sancerre/NZ) OR Pinot Grigio", "result_general": "Verdejo", "rationale": "Herbaceous whites complement poultry and fresh herbs." },
                                "Creamy/Sauced": { "result_specific": "Viognier (Cooler Climate) OR Dry Sparkling Wine", "result_general": "Unoaked Chardonnay", "rationale": "Viognier provides body/texture; Unoaked Chardonnay cuts creaminess." },
                                "Sweet/Fruity": { "result_specific": "Off-Dry Ros√© OR Pinot Gris (Alsace)", "result_general": "Riesling (Dry/Very Off-Dry)", "rationale": "Sweet/fruity profile complements glazes." },
                                "Savory/Cooked": { "result_specific": "Pinot Noir (Sancerre Rouge) OR Beaujolais-Villages", "result_general": "Dolcetto", "rationale": "Light, fruity reds are versatile for savory base." }
                            }
                        },
                        "Cheese / Dairy": {
                            "next_prompt": "5. Preparation:",
                            "options": {
                                "Fresh/Goat/Feta": { "result_specific": "Sauvignon Blanc (Sancerre) OR Dry Sparkling Wine", "result_general": "Cava", "rationale": "Sauvignon Blanc's acidity is the classic match for high-acid cheese." },
                                "Soft/Creamy": { "result_specific": "Oaked Chardonnay OR Dry Champagne", "result_general": "Pinot Blanc", "rationale": "Acidity and texture are key." },
                                "Hard/Aged": { "result_specific": "Dry Sherry (Fino/Manzanilla) OR Cru Beaujolais", "result_general": "Dry Cider (Artisanal)", "rationale": "Sherry is the best match for aged cheese." },
                                "Sweet/Fruity": { "result_specific": "Moscato d'Asti OR Off-Dry Ros√©", "result_general": "Brachetto d'Acqui", "rationale": "Lightly sweet, low-alcohol wines complement sweet garnish." }
                            }
                        },
                        "Vegetable / Herb Focused": {
                            "next_prompt": "5. Preparation:",
                            "options": {
                                "Pickled/Vinegary": { "result_specific": "Sauvignon Blanc (NZ) OR Sparkling Wine (Dry Cava)", "result_general": "Dry Ros√© (Crisp)", "rationale": "The wine must meet the vinegar's high acid, or sparkling wine will cleanse." },
                                "Savory/Earthy": { "result_specific": "Dry Fino Sherry OR Pinot Noir (Light)", "result_general": "Cru Beaujolais (Simple)", "rationale": "Sherry and light Pinot Noir excel with umami." },
                                "Sweet/Glazed": { "result_specific": "Riesling Kabinett OR Pinot Gris (Off-Dry)", "result_general": "Moscato d'Asti", "rationale": "The slight sweetness is necessary to match the fruit/sweet component." },
                                "Spicy/Peppery": { "result_specific": "Gr√ºner Veltliner OR Off-Dry Riesling", "result_general": "Dry Ros√© (Fruity)", "rationale": "Gr√ºner Veltliner is the best choice for vegetable dishes with a kick." }
                            }
                        }
                    }
                },
                // COURSE 2: APPETIZER
                "Appetizer / Second Course": {
                    "next_prompt": "4. Choose Category:",
                    "options": {
                        "Rich Terrine / P√¢t√©": {
                            "next_prompt": "5. Flavor Profile:",
                            "options": {
                                "Classic / Earthy (Truffle, herbs, liver focus)": { "result_specific": "Pinot Noir (Burgundy) OR Cru Beaujolais (Morgon)", "result_general": "Cabernet Franc", "rationale": "Earthy, savory notes need low tannin and good acidity to cut the fat." },
                                "Sweet / Fruity (Served with fig jam, cranberry)": { "result_specific": "Pinot Gris (Alsace) OR Chenin Blanc (Demi-Sec)", "result_general": "Gew√ºrztraminer", "rationale": "A rich white with residual sugar matches the sweetness of the fruit/jam." },
                                "Spiced / Peppery (Country p√¢t√© with peppercorns)": { "result_specific": "Syrah (Northern Rh√¥ne) OR Gr√ºner Veltliner (Smaragd)", "result_general": "Grenache/Garnacha", "rationale": "Syrah‚Äôs savory, peppery notes mirror the spices; Gr√ºner offers a white alternative with a signature pepper kick." }
                            }
                        },
                        "Lean Meat / Poultry": {
                            "next_prompt": "5. Flavor Profile:",
                            "options": {
                                "Cold / Cured (Prosciutto, Cold Roast slices)": { "result_specific": "Dry Sparkling Ros√© OR Dry Ros√© (Bandol)", "result_general": "Dry Lambrusco", "rationale": "High acidity and bubbles scrub the palate of salt and cured fat." },
                                "Warm / Creamy Sauce": { "result_specific": "Oaked Chardonnay OR Viognier", "result_general": "Unoaked Chardonnay", "rationale": "Wine needs body and texture to match the creamy sauce, with enough acidity." },
                                "Sweet / Fruity Sauce": { "result_specific": "Pinot Noir (New World) OR Cru Beaujolais (Fleurie)", "result_general": "Zinfandel (Lighter style)", "rationale": "Bright red fruit and low tannins complement the sweet fruit." },
                                "Acidic / Citrus / Vinaigrette": { "result_specific": "Sauvignon Blanc (Sancerre) OR Albari√±o", "result_general": "Verdejo", "rationale": "If dressed in lemon or vinegar, the wine must be high-acid and crisp." },
                                "Simple / Herbaceous": { "result_specific": "Sangiovese (Chianti) OR Pinot Noir (Sancerre Rouge)", "result_general": "Dolcetto", "rationale": "Savory, herbal, high-acid reds complement the herbs and protein." }
                            }
                        },
                        "Seafood (All Types)": {
                            "next_prompt": "5. Flavor Profile:",
                            "options": {
                                "Smoked / Cured / Salty": { "result_specific": "Dry Champagne (Blanc de Blancs) OR Chablis", "result_general": "Dry Cava (Brut Nature)", "rationale": "Salt and smoke require high acidity and bubbles to cleanse the palate and cut oiliness." },
                                "Rich / Buttery / Cream Sauce": { "result_specific": "Oaked Chardonnay OR White Rh√¥ne Blend", "result_general": "Viognier", "rationale": "Rich seafood needs a wine with weight and texture to match the sauce, plus acid." },
                                "Fresh / Raw / Zesty": { "result_specific": "Muscadet S√®vre et Maine OR Sancerre", "result_general": "Picpoul de Pinet", "rationale": "High minerality and acidity are non-negotiable to match the brine and citrus." },
                                "Sweet / Glazed / Spicy": { "result_specific": "Riesling (Feinherb/Off-Dry) OR Chenin Blanc (Demi-Sec)", "result_general": "Pinot Gris", "rationale": "Residual sugar balances the glaze's sweetness and soothes any spice." }
                            }
                        },
                        "Soup (Any)": {
                            "next_prompt": "5. Flavor Profile:",
                            "options": {
                                "Clear / Consomm√©": { "result_specific": "Dry Sherry (Fino or Manzanilla) OR Vermentino", "result_general": "Pinot Grigio", "rationale": "Needs savory, nutty nuances or very neutral, crisp fruit." },
                                "Creamy / Bisque": { "result_specific": "Pinot Gris (Alsace - Richer) OR Oaked Chardonnay", "result_general": "Viognier", "rationale": "The weight of the wine must match the weight of the soup." },
                                "Earthy / Vegetable": { "result_specific": "Pinot Noir (Earthy/Old World) OR Oaked Chardonnay", "result_general": "C√¥tes du Rh√¥ne (White or Red)", "rationale": "Earthy vegetables need wines with savory notes." }
                            }
                        },
                        "Fresh / Salads": {
                            "next_prompt": "5. Flavor Profile:",
                            "options": {
                                "Vinaigrette / Citrus Focus": { "result_specific": "Sauvignon Blanc (Marlborough) OR Albari√±o", "result_general": "Verdejo", "rationale": "If the dressing is acidic, the wine must be MORE acidic." },
                                "Creamy / Dairy Dressing": { "result_specific": "Sancerre OR Dry Ros√© (Provence)", "result_general": "Pinot Grigio", "rationale": "High acid cuts the fat of the cheese/dressing." },
                                "Fruit / Nut / Sweet Focus": { "result_specific": "Pinot Gris (Alsace) OR Off-Dry Riesling", "result_general": "Moscato d'Asti", "rationale": "Wine needs enough fruitiness and body to bridge the sweet/savory gap." }
                            }
                        },
                        "Vegetarian / Earthy": {
                            "next_prompt": "5. Flavor Profile:",
                            "options": {
                                "Mushroom / Truffle Focus": { "result_specific": "Pinot Noir (Burgundy) OR Nebbiolo (Langhe)", "result_general": "Rioja Crianza", "rationale": "Umami pairs perfectly with the earthy, savory notes of Pinot Noir or Nebbiolo." },
                                "Roasted / Sweet Veg (Pumpkin, Beets)": { "result_specific": "Chenin Blanc (South Africa) OR Viognier", "result_general": "Torront√©s", "rationale": "Aromatic whites with body and fruit notes complement this sweetness." },
                                "Creamy / Cheese Sauce (Souffl√©, Gratin)": { "result_specific": "Chablis OR Chenin Blanc (Dry)", "result_general": "Unoaked Chardonnay", "rationale": "High acid is needed to cut the warm cheese fat." },
                                "Acidic / Tomato / Vinaigrette (Artichoke)": { "result_specific": "Sauvignon Blanc (New Zealand) OR Vermentino", "result_general": "Pinot Grigio", "rationale": "Tomatoes and artichokes are high-acid; you need a crisp, zesty white to match." }
                            }
                        }
                    }
                },
                // COURSE 3: MAIN COURSE
                "Main Course": {
                    "next_prompt": "4. Choose Main Protein:",
                    "options": {
                        "Beef, Venison & Red Game": {
                            "next_prompt": "5. Preparation / Sauce:",
                            "options": {
                                "Wellington / P√¢t√© (Rich Gravy / Jus)": { "result_specific": "Pinot Noir (Earthy) OR Merlot (Right Bank)", "result_general": "Sangiovese", "rationale": "Softer tannins respect the pastry and mushroom; earthiness complements richness." },
                                "Simple Roast / Steak (Rich Gravy / Jus)": { "result_specific": "Cabernet Sauvignon OR Tempranillo", "result_general": "Shiraz/Syrah", "rationale": "High tannin is crucial to cut through the fat and protein." },
                                "Stew / Slow Cooked (Cream / Mushroom)": { "result_specific": "Syrah (Cool Climate) OR Zinfandel", "result_general": "Aglianico", "rationale": "Needs concentrated fruit and structure to match intense, long-cooked flavors." }
                            }
                        },
                        "Turkey & Chicken (Poultry)": {
                            "next_prompt": "5. Preparation / Sauce:",
                            "options": {
                                "Whole / Stuffed (Classic Herb Gravy)": { "result_specific": "Pinot Noir (Versatile) OR Chardonnay (Cool Climate, Light Oak)", "result_general": "Gamay", "rationale": "Medium body and earthy notes complement the herbs and poultry; high acidity keeps the palate fresh." },
                                "Simple Roast / Lean Cut (Cranberry / Fruit Sauce)": { "result_specific": "Dry Ros√© (Full-Bodied) OR Gew√ºrztraminer", "result_general": "Dry Riesling (High Acid)", "rationale": "Wine needs enough fruit and acidity to bridge the gap between lean meat and sweet/tart sauce." },
                                "Simple Roast / Lean Cut (Cream / Velout√©)": { "result_specific": "Oaked Chardonnay OR White Rh√¥ne Blend", "result_general": "Pinot Blanc", "rationale": "Creamy sauce requires a full-bodied white with sufficient acidity and texture." }
                            }
                        },
                        "Duck, Goose & Game Birds": {
                            "next_prompt": "5. Preparation / Sauce:",
                            "options": {
                                "Classic Fruit Sauce (Cherry, Plum, Orange)": { "result_specific": "Pinot Noir (High Acid/Old World) OR Riesling (Off-Dry/Feinherb)", "result_general": "Cru Beaujolais", "rationale": "High acidity is mandatory to cut the intense fat of the bird; fruit notes complement the classic sauces." },
                                "Rich Jus / Reduction (Port, Madeira)": { "result_specific": "Barolo/Barbaresco (Mature) OR Sangiovese", "result_general": "Aglianico", "rationale": "Wine needs savory complexity and structure to stand up to the concentrated richness of the sauce and game meat." },
                                "Spicy / Asian Glaze": { "result_specific": "Pinot Gris (Alsace) OR Gew√ºrztraminer", "result_general": "Dry Ros√© (Fuller Style)", "rationale": "Aromatic wines with an expressive flavor profile are the best complement to Asian/spicy notes." }
                            }
                        },
                        "Ham & Pork": {
                            "next_prompt": "5. Preparation / Sauce:",
                            "options": {
                                "Sweet / Maple Glaze": { "result_specific": "Off-Dry Riesling (Sp√§tlese) OR Zinfandel", "result_general": "Ros√© (Fruity/Off-Dry)", "rationale": "Wine must be sweeter than the glaze and high in acidity to cut through the saltiness." },
                                "Mustard / Spice Glaze": { "result_specific": "Dry Ros√© (Full-Bodied) OR Gr√ºner Veltliner", "result_general": "Dry Riesling", "rationale": "High acid is necessary to match the spice/mustard; Gr√ºner Veltliner complements spice well." },
                                "Acidic / Brine Focus": { "result_specific": "Dry Sherry (Amontillado) OR High Acid White Blend", "result_general": "Dry Madeira (Sercial)", "rationale": "High acidity is necessary to match the brine/vinegar." }
                            }
                        },
                        "Fish & Seafood Centerpieces": {
                            "next_prompt": "5. Preparation / Sauce:",
                            "options": {
                                "En Cro√ªte / Pastry (Rich Cream / Butter Sauce)": { "result_specific": "Oaked Chardonnay (Burgundy) OR White Rh√¥ne Blend", "result_general": "Pinot Gris (Rich Style)", "rationale": "Texture is key; needs body to stand up to the pastry and fat, but high acidity to cut the rich sauce." },
                                "Simple Roasted / Seared (Simple / Oil / Citrus)": { "result_specific": "Vermentino OR Assyrtiko", "result_general": "Dry Ros√© (Provence)", "rationale": "Light, simple preparation requires mineral-driven, zesty whites." },
                                "Rich / Shellfish Dish (Rich Cream / Butter Sauce)": { "result_specific": "Blanc de Blancs Champagne OR Chablis Premier Cru", "result_general": "Dry Sparkling Wine (Cava)", "rationale": "Needs extremely high acid and/or bubbles to cleanse the palate from rich cream/butter coating shellfish." }
                            }
                        },
                        "Vegetarian Centerpieces": {
                            "next_prompt": "5. Preparation / Sauce:",
                            "options": {
                                "Wellington / Nut Roast (Umami / Mushroom Gravy)": { "result_specific": "Pinot Noir (Earthy/Old World) OR Merlot", "result_general": "Cru Beaujolais", "rationale": "Earthy nuts/mushrooms and savory gravy pair best with low-tannin, earthy reds." },
                                "Stuffed / Baked Vegetables (Cream / Cheese Sauce)": { "result_specific": "Chenin Blanc (Dry, High Acid) OR Oaked Chardonnay", "result_general": "Verdejo", "rationale": "High-acid white wines with a savory edge cut the creaminess." },
                                "Stuffed / Baked Vegetables (Acidic / Tomato Sauce)": { "result_specific": "Sangiovese (Young) OR Sauvignon Blanc (Sancerre)", "result_general": "Dry Ros√© (Italian)", "rationale": "Tomato requires high acidity; choose a light red or structured white." }
                            }
                        }
                    }
                }
            }
        }
    }

            }
        };

        // ==========================================
        // STATE MANAGEMENT
        // ==========================================
        let currentPath = []; // Array of objects: { id: 'key', label: 'User Label', data: reference }
        let currentOptions = winePairings; 
        
        // Multi-select state
        let multiSelectMode = false;
        let selectedMultiOptions = [];

        // DOM Elements
        const breadcrumbsDiv = document.getElementById('breadcrumbs');
        const optionsContainer = document.getElementById('button-options-container');
        const stepPrompt = document.getElementById('step-prompt');
        const nextBtn = document.getElementById('next-step-btn');
        const warningMsg = document.getElementById('multi-warning');
        const resultDiv = document.getElementById('result');
        const resultTitle = document.getElementById('res-title');
        const stepsContainer = document.getElementById('steps-container');

        // ==========================================
        // FUNCTIONS
        // ==========================================

        function init() {
            renderOptions(winePairings, "1. Choose Cuisine Style:");
        }

        // --- Breadcrumbs ---
        function updateBreadcrumbs() {
            breadcrumbsDiv.innerHTML = '';
            
            // Create "Home" button
            const homeBtn = document.createElement('div');
            homeBtn.className = 'breadcrumb-item';
            homeBtn.innerHTML = 'üè† Start';
            homeBtn.onclick = () => resetApp();
            breadcrumbsDiv.appendChild(homeBtn);

            // Create items for path
            currentPath.forEach((step, index) => {
                const badge = document.createElement('div');
                badge.className = 'breadcrumb-item';
                badge.textContent = step.label;
                badge.onclick = () => handleBreadcrumbClick(index);
                breadcrumbsDiv.appendChild(badge);
            });
        }

        function handleBreadcrumbClick(index) {
            // Slice path to go back to that state
            // The item clicked is the one we want to KEEP being inside of? 
            // Actually, usually clicking a breadcrumb means "Go back to the state where I made this choice"
            // But visually, if I click "Italian", I expect to see the "Italian" options?
            // Let's make it: Click breadcrumb -> Go back to the step *after* that choice was made.
            
            // Logic: Re-traverse from root up to index
            let ptr = winePairings;
            for(let i=0; i<=index; i++) {
                let key = currentPath[i].id;
                // handle special traversal for mapped multi-select keys (complex, simplifying for now)
                if(ptr.options && ptr.options[key]) {
                    ptr = ptr.options[key];
                } else if (ptr.type === 'multi_select') {
                    // special handling if we are traversing BACK into a result of a multi-select
                    ptr = ptr.options[key]; 
                }
            }

            // Reset path
            currentPath = currentPath.slice(0, index + 1);
            currentOptions = ptr;
            
            // Hide results
            resultDiv.style.display = 'none';
            resultTitle.style.display = 'none';
            stepsContainer.style.display = 'block';

            // Check if we are at a result or options
            if(currentOptions.result_specific) {
                displayResult(currentOptions);
            } else {
                renderOptions(currentOptions.options || currentOptions, currentOptions.next_prompt || "Choose:");
            }
        }

        function resetApp() {
            currentPath = [];
            currentOptions = winePairings;
            resultDiv.style.display = 'none';
            resultTitle.style.display = 'none';
            stepsContainer.style.display = 'block';
            
            // Remove specific reset button if present inside container (old logic)
            const oldReset = document.getElementById('reset-button');
            if(oldReset) oldReset.remove();

            renderOptions(winePairings, "1. Choose Cuisine Style:");
        }

        // --- Render Logic ---
        function renderOptions(optionsObj, promptText) {
            updateBreadcrumbs();
            optionsContainer.innerHTML = '';
            stepPrompt.textContent = promptText;
            
            // Reset Multi-select UI
            multiSelectMode = false;
            selectedMultiOptions = [];
            nextBtn.style.display = 'none';
            warningMsg.style.display = 'none';

            // Check if this step is a "Multi-Select" special step (for Festive Sides)
            // The parent object passed in might have the 'type' property
            // We need to check if currentOptions has 'type': 'multi_select'
            
            if (currentOptions.type === 'multi_select') {
                renderMultiSelect(currentOptions);
                return;
            }

            // Standard render
            const keys = Object.keys(optionsObj).filter(k => k !== 'type' && k !== 'next_prompt' && k !== 'next_prompt_after_multi' && k !== 'choices');

            keys.forEach(key => {
                const btn = document.createElement('button');
                btn.className = 'emoji-button';
                
                let data = optionsObj[key];
                let label = data.user_label || key;
                let emoji = data.emoji || getEmoji(key); // Helper for emojis

                btn.innerHTML = `<span class="emoji">${emoji}</span> ${label}`;
                btn.onclick = () => handleSelection(key, label);
                optionsContainer.appendChild(btn);
            });
        }

        function renderMultiSelect(data) {
            multiSelectMode = true;
            stepPrompt.textContent = data.next_prompt;
            
            const choices = data.choices; // { A: "Label", B: "Label" }
            Object.keys(choices).forEach(code => {
                const btn = document.createElement('button');
                btn.className = 'emoji-button';
                btn.innerHTML = `<span class="emoji">üç≤</span> ${choices[code]}`;
                btn.dataset.code = code;
                
                btn.onclick = () => {
                    // Toggle selection
                    if (selectedMultiOptions.includes(code)) {
                        selectedMultiOptions = selectedMultiOptions.filter(c => c !== code);
                        btn.classList.remove('multi-select-active');
                    } else {
                        if (selectedMultiOptions.length < 2) {
                            selectedMultiOptions.push(code);
                            btn.classList.add('multi-select-active');
                        } else {
                            // Swap the last one if they click a 3rd? Or just block.
                            // Let's block 3rd click, maybe alert user visually
                            warningMsg.style.display = 'block';
                            setTimeout(() => warningMsg.style.display = 'none', 2000);
                        }
                    }
                };
                optionsContainer.appendChild(btn);
            });

            nextBtn.style.display = 'inline-block';
            nextBtn.onclick = handleMultiSelectSubmit;
        }

        // --- Handler Logic ---
        function handleSelection(key, label) {
            // Traverse
            let nextNode = currentOptions.options ? currentOptions.options[key] : currentOptions[key];
            
            // Handle missing data
            if (!nextNode || nextNode.user_label === "Not Implemented Yet") {
                alert("Data coming soon for this path!");
                return;
            }

            // Update State
            currentPath.push({ id: key, label: label });
            currentOptions = nextNode;

            // Check Result
            if (currentOptions.result_specific) {
                displayResult(currentOptions);
            } else {
                // If the next node is a Multi-Select definition wrapper
                if (currentOptions.type === 'multi_select') {
                     renderMultiSelect(currentOptions);
                } else {
                    // Standard next step
                    renderOptions(currentOptions.options || currentOptions, currentOptions.next_prompt);
                }
            }
        }

        function handleMultiSelectSubmit() {
            if (selectedMultiOptions.length === 0) {
                warningMsg.style.display = 'block';
                return;
            }

            // Generate Key (Sort alphabetically: A+B, not B+A)
            selectedMultiOptions.sort();
            let comboKey = selectedMultiOptions.join('+');
            
            // Check if specific combination exists in options, else try single, else default
            let nextNode = currentOptions.options[comboKey];
            
            // Fallback logic for complex trees: if A+B doesn't exist, try just A
            if (!nextNode && selectedMultiOptions.length > 0) {
                 nextNode = currentOptions.options[selectedMultiOptions[0]];
            }
            
            // Fallback for Fried Turkey demo if keys missing
            if (!nextNode && currentOptions.options['default']) {
                nextNode = currentOptions.options['default'];
            }

            if (!nextNode) {
                alert("Combination not found in data. Try a single selection.");
                return;
            }

            // Label for breadcrumb
            let readableLabel = selectedMultiOptions.map(c => currentOptions.choices[c]).join(" + ");

            // Move State
            currentPath.push({ id: comboKey, label: readableLabel });
            currentOptions = nextNode;

            // Check if mapping leads straight to options (Course style) or another prompt (Spread style)
            // In the Spread data structure: "A" -> { options: { "Heavy": ... } }
            
            // Render
             if (currentOptions.result_specific) {
                displayResult(currentOptions);
            } else {
                renderOptions(currentOptions.options || currentOptions, currentOptions.next_prompt || "Choose Preparation:");
            }
        }

        function displayResult(data) {
            updateBreadcrumbs();
            stepsContainer.style.display = 'none';
            resultDiv.style.display = 'block';
            resultTitle.style.display = 'block';
            
            let html = `
                <p>The **Absolute Best Pairing** is: <br><strong>${data.result_specific}</strong></p>
                <p style="margin-top: 15px;">A great **Available Alternative** is: <br><strong>${data.result_general}</strong></p>
                <div class="rationale">Rationale: ${data.rationale}</div>
                <button id="reset-button" onclick="resetApp()">Start Over ‚Ü∫</button>
            `;
            
            // Convert markdown bolds to HTML bolds
            html = html.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
            
            resultDiv.innerHTML = html;
        }

        // --- Helper for Emoji ---
        function getEmoji(key) {
            if (key.includes("Pasta")) return "üçù";
            if (key.includes("Risotto")) return "üçö";
            if (key.includes("Meat") || key.includes("Beef")) return "ü•©";
            if (key.includes("Fish") || key.includes("Seafood")) return "üêü";
            if (key.includes("Pizza")) return "üçï";
            if (key.includes("Vegetarian")) return "ü•ï";
            if (key.includes("Cheese")) return "üßÄ";
            if (key.includes("Spread")) return "ü¶É";
            if (key.includes("Turkey")) return "üçó";
            if (key.includes("Course")) return "üçΩÔ∏è";
            if (key.includes("Amuse")) return "ü•Ç";
            if (key.includes("Heavy") || key.includes("Roasted")) return "üî•";
            if (key.includes("Light") || key.includes("Fresh")) return "üçÉ";
            return "üç∑";
        }

        // Start
        init();

    </script>
</body>
</html>
